var Window=Class.create();Window.keepMultiModalWindow=false;Window.hasEffectLib=(typeof Effect!="undefined");Window.resizeEffectDuration=0.4;Window.prototype={initialize:function(){var c;var b=0;if(arguments.length>0){if(typeof arguments[0]=="string"){c=arguments[0];b=1}else{c=arguments[0]?arguments[0].id:null}}if(!c){c="window_"+new Date().getTime()}if($(c)){alert("Window "+c+" is already registered in the DOM! Make sure you use setDestroyOnClose() or destroyOnClose: true in the constructor")}this.options=Object.extend({className:"dialog",blurClassName:null,minWidth:100,minHeight:20,resizable:true,closable:true,minimizable:true,maximizable:true,draggable:true,userData:null,showEffect:(Window.hasEffectLib?Effect.Appear:Element.show),hideEffect:(Window.hasEffectLib?Effect.Fade:Element.hide),showEffectOptions:{},hideEffectOptions:{},effectOptions:null,parent:document.body,title:"&#160;",url:null,onload:Prototype.emptyFunction,width:200,height:300,opacity:1,recenterAuto:true,wiredDrag:false,closeCallback:null,destroyOnClose:false,gridX:1,gridY:1},arguments[b]||{});if(this.options.blurClassName){this.options.focusClassName=this.options.className}if(typeof this.options.top=="undefined"&&typeof this.options.bottom=="undefined"){this.options.top=this._round(Math.random()*500,this.options.gridY)}if(typeof this.options.left=="undefined"&&typeof this.options.right=="undefined"){this.options.left=this._round(Math.random()*500,this.options.gridX)}if(this.options.effectOptions){Object.extend(this.options.hideEffectOptions,this.options.effectOptions);Object.extend(this.options.showEffectOptions,this.options.effectOptions);if(this.options.showEffect==Element.Appear){this.options.showEffectOptions.to=this.options.opacity}}if(Window.hasEffectLib){if(this.options.showEffect==Effect.Appear){this.options.showEffectOptions.to=this.options.opacity}if(this.options.hideEffect==Effect.Fade){this.options.hideEffectOptions.from=this.options.opacity}}if(this.options.hideEffect==Element.hide){this.options.hideEffect=function(){Element.hide(this.element);if(this.options.destroyOnClose){this.destroy()}}.bind(this)}if(this.options.parent!=document.body){this.options.parent=$(this.options.parent)}this.element=this._createWindow(c);this.element.win=this;this.eventMouseDown=this._initDrag.bindAsEventListener(this);this.eventMouseUp=this._endDrag.bindAsEventListener(this);this.eventMouseMove=this._updateDrag.bindAsEventListener(this);this.eventOnLoad=this._getWindowBorderSize.bindAsEventListener(this);this.eventMouseDownContent=this.toFront.bindAsEventListener(this);this.eventResize=this._recenter.bindAsEventListener(this);this.topbar=$(this.element.id+"_top");this.bottombar=$(this.element.id+"_bottom");this.content=$(this.element.id+"_content");Event.observe(this.topbar,"mousedown",this.eventMouseDown);Event.observe(this.bottombar,"mousedown",this.eventMouseDown);Event.observe(this.content,"mousedown",this.eventMouseDownContent);Event.observe(window,"load",this.eventOnLoad);Event.observe(window,"resize",this.eventResize);Event.observe(window,"scroll",this.eventResize);Event.observe(this.options.parent,"scroll",this.eventResize);if(this.options.draggable){var a=this;[this.topbar,this.topbar.up().previous(),this.topbar.up().next()].each(function(d){d.observe("mousedown",a.eventMouseDown);d.addClassName("top_draggable")});[this.bottombar.up(),this.bottombar.up().previous(),this.bottombar.up().next()].each(function(d){d.observe("mousedown",a.eventMouseDown);d.addClassName("bottom_draggable")})}if(this.options.resizable){this.sizer=$(this.element.id+"_sizer");Event.observe(this.sizer,"mousedown",this.eventMouseDown)}this.useLeft=null;this.useTop=null;if(typeof this.options.left!="undefined"){this.element.setStyle({left:parseFloat(this.options.left)+"px"});this.useLeft=true}else{this.element.setStyle({right:parseFloat(this.options.right)+"px"});this.useLeft=false}if(typeof this.options.top!="undefined"){this.element.setStyle({top:parseFloat(this.options.top)+"px"});this.useTop=true}else{this.element.setStyle({bottom:parseFloat(this.options.bottom)+"px"});this.useTop=false}this.storedLocation=null;this.setOpacity(this.options.opacity);if(this.options.zIndex){this.setZIndex(this.options.zIndex)}if(this.options.destroyOnClose){this.setDestroyOnClose(true)}this._getWindowBorderSize();this.width=this.options.width;this.height=this.options.height;this.visible=false;this.constraint=false;this.constraintPad={top:0,left:0,bottom:0,right:0};if(this.width&&this.height){this.setSize(this.options.width,this.options.height)}this.setTitle(this.options.title);Windows.register(this)},destroy:function(){this._notify("onDestroy");Event.stopObserving(this.topbar,"mousedown",this.eventMouseDown);Event.stopObserving(this.bottombar,"mousedown",this.eventMouseDown);Event.stopObserving(this.content,"mousedown",this.eventMouseDownContent);Event.stopObserving(window,"load",this.eventOnLoad);Event.stopObserving(window,"resize",this.eventResize);Event.stopObserving(window,"scroll",this.eventResize);Event.stopObserving(this.content,"load",this.options.onload);if(this._oldParent){var c=this.getContent();var a=null;for(var b=0;b<c.childNodes.length;b++){a=c.childNodes[b];if(a.nodeType==1){break}a=null}if(a){$(a).hide();this._oldParent.appendChild(a)}this._oldParent=null}if(this.sizer){Event.stopObserving(this.sizer,"mousedown",this.eventMouseDown)}if(this.options.url){this.content.src=null}if(this.iefix){Element.remove(this.iefix)}Element.remove(this.element);Windows.unregister(this);if(Dialog){Dialog.dialogId=null}},setCloseCallback:function(a){this.options.closeCallback=a},getContent:function(){return this.content},setContent:function(h,g,b){var a=$(h);if(null==a){throw"Unable to find element '"+h+"' in DOM"}this._oldParent=a.parentNode;var f=null;var e=null;if(g){f=Element.getDimensions(a)}if(b){e=Position.cumulativeOffset(a)}var c=this.getContent();this.setHTMLContent("");c=this.getContent();c.appendChild(a);a.show();if(g){this.setSize(f.width,f.height)}if(b){this.setLocation(e[1]-this.heightN,e[0]-this.widthW)}},setHTMLContent:function(a){if(this.options.url){this.content.src=null;this.options.url=null;var b='<div id="'+this.getId()+'_content" class="'+this.options.className+'_content"> </div>';$(this.getId()+"_table_content").innerHTML=b;this.content=$(this.element.id+"_content")}this.getContent().innerHTML=a},setAjaxContent:function(b,a,d,c){this.showFunction=d?"showCenter":"show";this.showModal=c||false;a=a||{};this.setHTMLContent("");this.onComplete=a.onComplete;if(!this._onCompleteHandler){this._onCompleteHandler=this._setAjaxContent.bind(this)}a.onComplete=this._onCompleteHandler;new Ajax.Request(b,a);a.onComplete=this.onComplete},_setAjaxContent:function(a){Element.update(this.getContent(),a.responseText);if(this.onComplete){this.onComplete(a)}this.onComplete=null;this[this.showFunction](this.showModal)},setURL:function(a){if(this.options.url){this.content.src=null}this.options.url=a;var b="<iframe frameborder='0' name='"+this.getId()+"_content'  id='"+this.getId()+"_content' src='"+a+"' width='"+this.width+"' height='"+this.height+"'> </iframe>";$(this.getId()+"_table_content").innerHTML=b;this.content=$(this.element.id+"_content")},getURL:function(){return this.options.url?this.options.url:null},refresh:function(){if(this.options.url){$(this.element.getAttribute("id")+"_content").src=this.options.url}},setCookie:function(b,c,n,e,a){b=b||this.element.id;this.cookie=[b,c,n,e,a];var l=WindowUtilities.getCookie(b);if(l){var m=l.split(",");var j=m[0].split(":");var i=m[1].split(":");var k=parseFloat(m[2]),f=parseFloat(m[3]);var g=m[4];var d=m[5];this.setSize(k,f);if(g=="true"){this.doMinimize=true}else{if(d=="true"){this.doMaximize=true}}this.useLeft=j[0]=="l";this.useTop=i[0]=="t";this.element.setStyle(this.useLeft?{left:j[1]}:{right:j[1]});this.element.setStyle(this.useTop?{top:i[1]}:{bottom:i[1]})}},getId:function(){return this.element.id},setDestroyOnClose:function(){this.options.destroyOnClose=true},setConstraint:function(a,b){this.constraint=a;this.constraintPad=Object.extend(this.constraintPad,b||{});if(this.useTop&&this.useLeft){this.setLocation(parseFloat(this.element.style.top),parseFloat(this.element.style.left))}},_initDrag:function(b){if(Event.element(b)==this.sizer&&this.isMinimized()){return}if(Event.element(b)!=this.sizer&&this.isMaximized()){return}if(Prototype.Browser.IE&&this.heightN==0){this._getWindowBorderSize()}this.pointer=[this._round(Event.pointerX(b),this.options.gridX),this._round(Event.pointerY(b),this.options.gridY)];if(this.options.wiredDrag){this.currentDrag=this._createWiredElement()}else{this.currentDrag=this.element}if(Event.element(b)==this.sizer){this.doResize=true;this.widthOrg=this.width;this.heightOrg=this.height;this.bottomOrg=parseFloat(this.element.getStyle("bottom"));this.rightOrg=parseFloat(this.element.getStyle("right"));this._notify("onStartResize")}else{this.doResize=false;var a=$(this.getId()+"_close");if(a&&Position.within(a,this.pointer[0],this.pointer[1])){this.currentDrag=null;return}this.toFront();if(!this.options.draggable){return}this._notify("onStartMove")}Event.observe(document,"mouseup",this.eventMouseUp,false);Event.observe(document,"mousemove",this.eventMouseMove,false);WindowUtilities.disableScreen("__invisible__","__invisible__",this.overlayOpacity);document.body.ondrag=function(){return false};document.body.onselectstart=function(){return false};this.currentDrag.show()},_round:function(b,a){return a==1?b:b=Math.floor(b/a)*a},_updateDrag:function(b){if(!this.currentDrag){return}var a=[this._round(Event.pointerX(b),this.options.gridX),this._round(Event.pointerY(b),this.options.gridY)];var k=a[0]-this.pointer[0];var j=a[1]-this.pointer[1];if(this.doResize){var i=this.widthOrg+k;var d=this.heightOrg+j;k=this.width-this.widthOrg;j=this.height-this.heightOrg;if(this.useLeft){i=this._updateWidthConstraint(i)}else{this.currentDrag.setStyle({right:(this.rightOrg-k)+"px"})}if(this.useTop){d=this._updateHeightConstraint(d)}else{this.currentDrag.setStyle({bottom:(this.bottomOrg-j)+"px"})}this.setSize(i,d);this._notify("onResize")}else{this.pointer=a;if(this.useLeft){var c=parseFloat(this.currentDrag.getStyle("left"))+k;var g=this._updateLeftConstraint(c);this.pointer[0]+=g-c;this.currentDrag.setStyle({left:g+"px"})}else{this.currentDrag.setStyle({right:parseFloat(this.currentDrag.getStyle("right"))-k+"px"})}if(this.useTop){var f=parseFloat(this.currentDrag.getStyle("top"))+j;var e=this._updateTopConstraint(f);this.pointer[1]+=e-f;this.currentDrag.setStyle({top:e+"px"})}else{this.currentDrag.setStyle({bottom:parseFloat(this.currentDrag.getStyle("bottom"))-j+"px"})}this._notify("onMove")}if(this.iefix){this._fixIEOverlapping()}this._removeStoreLocation();Event.stop(b)},_endDrag:function(a){WindowUtilities.enableScreen("__invisible__");if(this.doResize){this._notify("onEndResize")}else{this._notify("onEndMove")}Event.stopObserving(document,"mouseup",this.eventMouseUp,false);Event.stopObserving(document,"mousemove",this.eventMouseMove,false);Event.stop(a);this._hideWiredElement();this._saveCookie();document.body.ondrag=null;document.body.onselectstart=null},_updateLeftConstraint:function(b){if(this.constraint&&this.useLeft&&this.useTop){var a=this.options.parent==document.body?WindowUtilities.getPageSize().windowWidth:this.options.parent.getDimensions().width;if(b<this.constraintPad.left){b=this.constraintPad.left}if(b+this.width+this.widthE+this.widthW>a-this.constraintPad.right){b=a-this.constraintPad.right-this.width-this.widthE-this.widthW}}return b},_updateTopConstraint:function(c){if(this.constraint&&this.useLeft&&this.useTop){var a=this.options.parent==document.body?WindowUtilities.getPageSize().windowHeight:this.options.parent.getDimensions().height;var b=this.height+this.heightN+this.heightS;if(c<this.constraintPad.top){c=this.constraintPad.top}if(c+b>a-this.constraintPad.bottom){c=a-this.constraintPad.bottom-b}}return c},_updateWidthConstraint:function(a){if(this.constraint&&this.useLeft&&this.useTop){var b=this.options.parent==document.body?WindowUtilities.getPageSize().windowWidth:this.options.parent.getDimensions().width;var c=parseFloat(this.element.getStyle("left"));if(c+a+this.widthE+this.widthW>b-this.constraintPad.right){a=b-this.constraintPad.right-c-this.widthE-this.widthW}}return a},_updateHeightConstraint:function(b){if(this.constraint&&this.useLeft&&this.useTop){var a=this.options.parent==document.body?WindowUtilities.getPageSize().windowHeight:this.options.parent.getDimensions().height;var c=parseFloat(this.element.getStyle("top"));if(c+b+this.heightN+this.heightS>a-this.constraintPad.bottom){b=a-this.constraintPad.bottom-c-this.heightN-this.heightS}}return b},_createWindow:function(h){var e=this.options.className;var g=document.createElement("div");g.setAttribute("id",h);g.className="dialog";var f;if(this.options.url){f='<iframe frameborder="0" name="'+h+'_content"  id="'+h+'_content" src="'+this.options.url+'"> </iframe>'}else{f='<div id="'+h+'_content" class="'+e+'_content"> </div>'}var c=this.options.closable?"<div class='"+e+"_close' id='"+h+"_close' onclick='Windows.close(\""+h+"\", event)'> </div>":"";var b=this.options.minimizable?"<div class='"+e+"_minimize' id='"+h+"_minimize' onclick='Windows.minimize(\""+h+"\", event)'> </div>":"";var a=this.options.maximizable?"<div class='"+e+"_maximize' id='"+h+"_maximize' onclick='Windows.maximize(\""+h+"\", event)'> </div>":"";var d=this.options.resizable?"class='"+e+"_sizer' id='"+h+"_sizer'":"class='"+e+"_se'";g.innerHTML=c+b+a+"      <table id='"+h+"_row1' class=\"top table_window\">        <tr>          <td class='"+e+"_nw'></td>          <td class='"+e+"_n'><div id='"+h+"_top' class='"+e+"_title title_window'>"+this.options.title+"</div></td>          <td class='"+e+"_ne'></td>        </tr>      </table>      <table id='"+h+"_row2' class=\"mid table_window\">        <tr>          <td class='"+e+"_w'></td>            <td id='"+h+"_table_content' class='"+e+"_content' valign='top'>"+f+"</td>          <td class='"+e+"_e'></td>        </tr>      </table>        <table id='"+h+"_row3' class=\"bot table_window\">        <tr>          <td class='"+e+"_sw'></td>            <td class='"+e+"_s'><div id='"+h+"_bottom' class='status_bar'><span style='float:left; width:1px; height:1px'></span></div></td>            <td "+d+"></td>        </tr>      </table>    ";Element.hide(g);this.options.parent.insertBefore(g,this.options.parent.firstChild);Event.observe($(h+"_content"),"load",this.options.onload);return g},changeClassName:function(a){var b=this.options.className;var c=this.getId();$A(["_close","_minimize","_maximize","_sizer","_content"]).each(function(d){this._toggleClassName($(c+d),b+d,a+d)}.bind(this));this._toggleClassName($(c+"_top"),b+"_title",a+"_title");$$("#"+c+" td").each(function(d){d.className=d.className.sub(b,a)});this.options.className=a},_toggleClassName:function(c,b,a){if(c){c.removeClassName(b);c.addClassName(a)}},setLocation:function(c,b){c=this._updateTopConstraint(c);b=this._updateLeftConstraint(b);var a=this.currentDrag||this.element;a.setStyle({top:c+"px"});a.setStyle({left:b+"px"});this.useLeft=true;this.useTop=true},getLocation:function(){var a={};if(this.useTop){a=Object.extend(a,{top:this.element.getStyle("top")})}else{a=Object.extend(a,{bottom:this.element.getStyle("bottom")})}if(this.useLeft){a=Object.extend(a,{left:this.element.getStyle("left")})}else{a=Object.extend(a,{right:this.element.getStyle("right")})}return a},getSize:function(){return{width:this.width,height:this.height}},setSize:function(c,b,a){c=parseFloat(c);b=parseFloat(b);if(!this.minimized&&c<this.options.minWidth){c=this.options.minWidth}if(!this.minimized&&b<this.options.minHeight){b=this.options.minHeight}if(this.options.maxHeight&&b>this.options.maxHeight){b=this.options.maxHeight}if(this.options.maxWidth&&c>this.options.maxWidth){c=this.options.maxWidth}if(this.useTop&&this.useLeft&&Window.hasEffectLib&&Effect.ResizeWindow&&a){new Effect.ResizeWindow(this,null,null,c,b,{duration:Window.resizeEffectDuration})}else{this.width=c;this.height=b;var f=this.currentDrag?this.currentDrag:this.element;f.setStyle({width:c+this.widthW+this.widthE+"px"});f.setStyle({height:b+this.heightN+this.heightS+"px"});if(!this.currentDrag||this.currentDrag==this.element){var d=$(this.element.id+"_content");if(d){d.setStyle({height:b+"px"});d.setStyle({width:c+"px"})}}}},updateHeight:function(){if(this.content.firstDescendant()){this.setSize(this.width,this.content.firstDescendant().scrollHeight,true)}else{this.setSize(this.width,this.content.scrollHeight,true)}},updateWidth:function(){this.setSize(this.content.scrollWidth,this.height,true)},toFront:function(){if(this.element.style.zIndex<Windows.maxZIndex){this.setZIndex(Windows.maxZIndex+1)}if(this.iefix){this._fixIEOverlapping()}},getBounds:function(b){if(!this.width||!this.height||!this.visible){this.computeBounds()}var a=this.width;var c=this.height;if(!b){a+=this.widthW+this.widthE;c+=this.heightN+this.heightS}var d=Object.extend(this.getLocation(),{width:a+"px",height:c+"px"});return d},computeBounds:function(){if(!this.width||!this.height){var a=WindowUtilities._computeSize(this.content.innerHTML,this.content.id,this.width,this.height,0,this.options.className);if(this.height){this.width=a+5}else{this.height=a+5}}this.setSize(this.width,this.height);if(this.centered){this._center(this.centerTop,this.centerLeft)}},show:function(b){if(!Gcc.enableModalScrollbar){$$("html")[0].setStyle({overflow:"hidden"})}this.visible=true;if(b){if(typeof this.overlayOpacity=="undefined"){var a=this;setTimeout(function(){a.show(b)},10);return}Windows.addModalWindow(this);this.modal=true;this.setZIndex(Windows.maxZIndex+1);Windows.unsetOverflow(this);Dialog._focusBtn(Windows.focusedWindow.getId())}else{if(!this.element.style.zIndex){this.setZIndex(Windows.maxZIndex+1)}}if(this.oldStyle){this.getContent().setStyle({overflow:this.oldStyle})}this.computeBounds();this._notify("onBeforeShow");if(this.options.showEffect!=Element.show&&this.options.showEffectOptions){this.options.showEffect(this.element,this.options.showEffectOptions)}else{this.options.showEffect(this.element)}WindowUtilities.focusedWindow=this;this._notify("onShow")},showCenter:function(a,c,b){this.centered=true;this.centerTop=c;this.centerLeft=b;this.show(a)},isVisible:function(){return this.visible},_center:function(c,b){var d=WindowUtilities.getWindowScroll(this.options.parent);var a=WindowUtilities.getPageSize(this.options.parent);if(typeof c=="undefined"){c=(a.windowHeight-(this.height+this.heightN+this.heightS))/2}c+=d.top;if(typeof b=="undefined"){b=(a.windowWidth-(this.width+this.widthW+this.widthE))/2}b+=d.left;this.setLocation(c,b);this.toFront()},_recenter:function(){if(this.centered){var a=WindowUtilities.getPageSize(this.options.parent);var b=WindowUtilities.getWindowScroll(this.options.parent);if(this.pageSize&&this.pageSize.windowWidth==a.windowWidth&&this.pageSize.windowHeight==a.windowHeight&&this.windowScroll.left==b.left&&this.windowScroll.top==b.top){return}this.pageSize=a;this.windowScroll=b;if($("overlay_modal")){$("overlay_modal").setStyle({height:(a.pageHeight-9+"px")})}if(this.options.recenterAuto){this._center(this.centerTop,this.centerLeft)}}},hide:function(){if(Windows.windows.length==1){$$("html")[0].setStyle({overflow:"auto"})}this.visible=false;if(this.modal){Windows.removeModalWindow(this);Windows.resetOverflow()}this.oldStyle=this.getContent().getStyle("overflow")||"auto";this.getContent().setStyle({overflow:"hidden"});this.options.hideEffect(this.element,this.options.hideEffectOptions);if(this.iefix){this.iefix.hide()}if(!this.doNotNotifyHide){this._notify("onHide")}},close:function(){if(this.visible){if(this.options.closeCallback&&!this.options.closeCallback(this)){return}if(this.options.destroyOnClose){var a=this.destroy.bind(this);if(this.options.hideEffectOptions.afterFinish){var b=this.options.hideEffectOptions.afterFinish;this.options.hideEffectOptions.afterFinish=function(){b();a()}}else{this.options.hideEffectOptions.afterFinish=function(){a()}}}Windows.updateFocusedWindow();this.doNotNotifyHide=true;this.hide();this.doNotNotifyHide=false;this._notify("onClose")}},minimize:function(){if(this.resizing){return}var a=$(this.getId()+"_row2");if(!this.minimized){this.minimized=true;var d=a.getDimensions().height;this.r2Height=d;var c=this.element.getHeight()-d;if(this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow){new Effect.ResizeWindow(this,null,null,null,this.height-d,{duration:Window.resizeEffectDuration})}else{this.height-=d;this.element.setStyle({height:c+"px"});a.hide()}if(!this.useTop){var b=parseFloat(this.element.getStyle("bottom"));this.element.setStyle({bottom:(b+d)+"px"})}}else{this.minimized=false;var d=this.r2Height;this.r2Height=null;if(this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow){new Effect.ResizeWindow(this,null,null,null,this.height+d,{duration:Window.resizeEffectDuration})}else{var c=this.element.getHeight()+d;this.height+=d;this.element.setStyle({height:c+"px"});a.show()}if(!this.useTop){var b=parseFloat(this.element.getStyle("bottom"));this.element.setStyle({bottom:(b-d)+"px"})}this.toFront()}this._notify("onMinimize");this._saveCookie()},maximize:function(){if(this.isMinimized()||this.resizing){return}if(Prototype.Browser.IE&&this.heightN==0){this._getWindowBorderSize()}if(this.storedLocation!=null){this._restoreLocation();if(this.iefix){this.iefix.hide()}}else{this._storeLocation();Windows.unsetOverflow(this);var g=WindowUtilities.getWindowScroll(this.options.parent);var b=WindowUtilities.getPageSize(this.options.parent);var f=g.left;var e=g.top;if(this.options.parent!=document.body){g={top:0,left:0,bottom:0,right:0};var d=this.options.parent.getDimensions();b.windowWidth=d.width;b.windowHeight=d.height;e=0;f=0}if(this.constraint){b.windowWidth-=Math.max(0,this.constraintPad.left)+Math.max(0,this.constraintPad.right);b.windowHeight-=Math.max(0,this.constraintPad.top)+Math.max(0,this.constraintPad.bottom);f+=Math.max(0,this.constraintPad.left);e+=Math.max(0,this.constraintPad.top)}var c=b.windowWidth-this.widthW-this.widthE;var a=b.windowHeight-this.heightN-this.heightS;if(this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow){new Effect.ResizeWindow(this,e,f,c,a,{duration:Window.resizeEffectDuration})}else{this.setSize(c,a);this.element.setStyle(this.useLeft?{left:f}:{right:f});this.element.setStyle(this.useTop?{top:e}:{bottom:e})}this.toFront();if(this.iefix){this._fixIEOverlapping()}}this._notify("onMaximize");this._saveCookie()},isMinimized:function(){return this.minimized},isMaximized:function(){return(this.storedLocation!=null)},setOpacity:function(a){if(Element.setOpacity){Element.setOpacity(this.element,a)}},setZIndex:function(a){this.element.setStyle({zIndex:a});Windows.updateZindex(a,this)},setTitle:function(a){if(!a||a==""){a="&#160;"}Element.update(this.element.id+"_top",a)},getTitle:function(){return $(this.element.id+"_top").innerHTML},setStatusBar:function(a){if(typeof(a)=="object"){if(this.bottombar.firstChild){this.bottombar.replaceChild(a,this.bottombar.firstChild)}else{this.bottombar.appendChild(a)}}else{this.bottombar.innerHTML=a}},_checkIEOverlapping:function(){if(!this.iefix&&(navigator.appVersion.indexOf("MSIE")>0)&&(navigator.userAgent.indexOf("Opera")<0)&&(this.element.getStyle("position")=="absolute")){new Insertion.After(this.element.id,'<iframe id="'+this.element.id+'_iefix" style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);" src="javascript:false;" frameborder="0" scrolling="no"></iframe>');this.iefix=$(this.element.id+"_iefix")}if(this.iefix){setTimeout(this._fixIEOverlapping.bind(this),50)}},_fixIEOverlapping:function(){Position.clone(this.element,this.iefix);this.iefix.style.zIndex=this.element.style.zIndex-1;this.iefix.show()},_getWindowBorderSize:function(){var b;b=this._createHiddenDiv(this.options.className+"_n");this.heightN=Element.getDimensions(b).height;b.parentNode.removeChild(b);b=this._createHiddenDiv(this.options.className+"_s");this.heightS=Element.getDimensions(b).height;b.parentNode.removeChild(b);b=this._createHiddenDiv(this.options.className+"_e");this.widthE=Element.getDimensions(b).width;b.parentNode.removeChild(b);b=this._createHiddenDiv(this.options.className+"_w");this.widthW=Element.getDimensions(b).width;b.parentNode.removeChild(b);b=document.createElement("div");b.className="overlay_"+this.options.className;document.body.appendChild(b);var a=this;setTimeout(function(){a.overlayOpacity=($(b).getStyle("opacity"));b.parentNode.removeChild(b)},10);if(Prototype.Browser.IE){if($(this.getId()+"_row3")){this.heightS=$(this.getId()+"_row3").getDimensions().height}if($(this.getId()+"_row1")){this.heightN=$(this.getId()+"_row1").getDimensions().height}}if(Prototype.Browser.WebKit&&Prototype.Browser.WebKitVersion<420){this.setSize(this.width,this.height)}if(this.doMaximize){this.maximize()}if(this.doMinimize){this.minimize()}},_createHiddenDiv:function(b){var a=document.body;var c=document.createElement("div");c.setAttribute("id",this.element.id+"_tmp");c.className=b;c.style.display="none";c.innerHTML="";a.insertBefore(c,a.firstChild);return c},_storeLocation:function(){if(this.storedLocation==null){this.storedLocation={useTop:this.useTop,useLeft:this.useLeft,top:this.element.getStyle("top"),bottom:this.element.getStyle("bottom"),left:this.element.getStyle("left"),right:this.element.getStyle("right"),width:this.width,height:this.height}}},_restoreLocation:function(){if(this.storedLocation!=null){this.useLeft=this.storedLocation.useLeft;this.useTop=this.storedLocation.useTop;if(this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow){new Effect.ResizeWindow(this,this.storedLocation.top,this.storedLocation.left,this.storedLocation.width,this.storedLocation.height,{duration:Window.resizeEffectDuration})}else{this.element.setStyle(this.useLeft?{left:this.storedLocation.left}:{right:this.storedLocation.right});this.element.setStyle(this.useTop?{top:this.storedLocation.top}:{bottom:this.storedLocation.bottom});this.setSize(this.storedLocation.width,this.storedLocation.height)}Windows.resetOverflow();this._removeStoreLocation()}},_removeStoreLocation:function(){this.storedLocation=null},_saveCookie:function(){if(this.cookie){var a="";if(this.useLeft){a+="l:"+(this.storedLocation?this.storedLocation.left:this.element.getStyle("left"))}else{a+="r:"+(this.storedLocation?this.storedLocation.right:this.element.getStyle("right"))}if(this.useTop){a+=",t:"+(this.storedLocation?this.storedLocation.top:this.element.getStyle("top"))}else{a+=",b:"+(this.storedLocation?this.storedLocation.bottom:this.element.getStyle("bottom"))}a+=","+(this.storedLocation?this.storedLocation.width:this.width);a+=","+(this.storedLocation?this.storedLocation.height:this.height);a+=","+this.isMinimized();a+=","+this.isMaximized();WindowUtilities.setCookie(a,this.cookie)}},_createWiredElement:function(){if(!this.wiredElement){if(Prototype.Browser.IE){this._getWindowBorderSize()}var b=document.createElement("div");b.className="wired_frame "+this.options.className+"_wired_frame";b.style.position="absolute";this.options.parent.insertBefore(b,this.options.parent.firstChild);this.wiredElement=$(b)}if(this.useLeft){this.wiredElement.setStyle({left:this.element.getStyle("left")})}else{this.wiredElement.setStyle({right:this.element.getStyle("right")})}if(this.useTop){this.wiredElement.setStyle({top:this.element.getStyle("top")})}else{this.wiredElement.setStyle({bottom:this.element.getStyle("bottom")})}var a=this.element.getDimensions();this.wiredElement.setStyle({width:a.width+"px",height:a.height+"px"});this.wiredElement.setStyle({zIndex:Windows.maxZIndex+30});return this.wiredElement},_hideWiredElement:function(){if(!this.currentDrag){return}if(this.currentDrag==this.element){this.currentDrag=null}else{if(this.useLeft){this.element.setStyle({left:this.currentDrag.getStyle("left")})}else{this.element.setStyle({right:this.currentDrag.getStyle("right")})}if(this.useTop){this.element.setStyle({top:this.currentDrag.getStyle("top")})}else{this.element.setStyle({bottom:this.currentDrag.getStyle("bottom")})}this.currentDrag.hide();this.currentDrag=null;if(this.doResize){this.setSize(this.width,this.height)}}},_notify:function(a){if(this.options[a]){this.options[a](this)}else{Windows.notify(a,this)}}};var Windows={windows:[],modalWindows:[],observers:[],focusedWindow:null,maxZIndex:0,overlayShowEffectOptions:{duration:0.5},overlayHideEffectOptions:{duration:0.5},focusBtnIndex:null,addObserver:function(a){this.removeObserver(a);this.observers.push(a)},removeObserver:function(a){this.observers=this.observers.reject(function(b){return b==a})},notify:function(a,b){this.observers.each(function(c){if(c[a]){c[a](a,b)}})},getWindow:function(a){return this.windows.detect(function(b){return b.getId()==a})},getFocusedWindow:function(){return this.focusedWindow},updateFocusedWindow:function(){this.focusedWindow=this.windows.length>=2?this.windows[this.windows.length-2]:null},addModalWindow:function(a){if(this.modalWindows.length==0){WindowUtilities.disableScreen(a.options.className,"overlay_modal",a.overlayOpacity,a.getId(),a.options.parent)}else{if(Window.keepMultiModalWindow){if($("overlay_modal")){$("overlay_modal").style.zIndex=Windows.maxZIndex+1}Windows.maxZIndex+=1;WindowUtilities._hideSelect(this.modalWindows.last().getId())}else{this.modalWindows.last().element.hide()}WindowUtilities._showSelect(a.getId())}this.modalWindows.push(a)},removeModalWindow:function(){this.modalWindows.pop();if(this.modalWindows.length==0){WindowUtilities.enableScreen()}else{if(Window.keepMultiModalWindow){this.modalWindows.last().toFront();WindowUtilities._showSelect(this.modalWindows.last().getId())}else{this.modalWindows.last().element.show()}}},register:function(a){this.windows.push(a)},unregister:function(a){this.windows=this.windows.reject(function(b){return b==a})},closeAll:function(){this.windows.each(function(a){Windows.close(a.getId())})},closeAllModalWindows:function(){WindowUtilities.enableScreen();this.modalWindows.each(function(a){if(a){a.close()}})},minimize:function(c,a){var b=this.getWindow(c);if(b&&b.visible){b.minimize()}Event.stop(a)},maximize:function(c,a){var b=this.getWindow(c);if(b&&b.visible){b.maximize()}Event.stop(a)},close:function(c,a){var b=this.getWindow(c);if(b){if(Windows.windows.length==1){$$("html")[0].setStyle({overflow:"auto"})}b.close()}if(a){Event.stop(a)}},blur:function(b){var a=this.getWindow(b);if(!a){return}if(a.options.blurClassName){a.changeClassName(a.options.blurClassName)}if(this.focusedWindow==a){this.focusedWindow=null}a._notify("onBlur")},focus:function(b){var a=this.getWindow(b);if(!a){return}if(this.focusedWindow){this.blur(this.focusedWindow.getId())}if(a.options.focusClassName){a.changeClassName(a.options.focusClassName)}this.focusedWindow=a;a._notify("onFocus")},unsetOverflow:function(a){this.windows.each(function(b){b.oldOverflow=b.getContent().getStyle("overflow")||"auto";b.getContent().setStyle({overflow:"hidden"})});if(a&&a.oldOverflow){a.getContent().setStyle({overflow:a.oldOverflow})}},resetOverflow:function(){this.windows.each(function(a){if(a.oldOverflow){a.getContent().setStyle({overflow:a.oldOverflow})}})},updateZindex:function(a,b){if(a>this.maxZIndex){this.maxZIndex=a;if(this.focusedWindow){this.blur(this.focusedWindow.getId())}}this.focusedWindow=b;if(this.focusedWindow){this.focus(this.focusedWindow.getId())}}};var Dialog={dialogId:null,onCompleteFunc:null,callFunc:null,parameters:null,focusBtnIndex:0,confirm:function(d,c){if(d&&typeof d!="string"){Dialog._runAjaxRequest(d,c,Dialog.confirm);return}d=d||"";c=c||{};var f=c.okLabel?c.okLabel:"Ok";var a=c.cancelLabel?c.cancelLabel:"Cancel";c=Object.extend(c,c.windowParameters||{});c.windowParameters=c.windowParameters||{};c.className=c.className||"alert";var b="class ='"+(c.buttonClass?c.buttonClass+" ":"")+" ok_button'";var e="class ='"+(c.buttonClass?c.buttonClass+" ":"")+" cancel_button'";d="      <div class='"+c.className+"_message'>"+d+"</div>        <div class='"+c.className+"_buttons'>          <input type='button' value='"+f+"' onclick='Dialog.okCallback()' "+b+"/>          <input type='button' value='"+a+"' onclick='Dialog.cancelCallback()' "+e+"/>        </div>    ";Dialog.focusBtnIndex=Windows.focusBtnIndex!=null?Windows.focusBtnIndex:1;return this._openDialog(d,c)},alert:function(c,b){if(c&&typeof c!="string"){Dialog._runAjaxRequest(c,b,Dialog.alert);return}c=c||"";b=b||{};var d=b.okLabel?b.okLabel:"Ok";b=Object.extend(b,b.windowParameters||{});b.windowParameters=b.windowParameters||{};b.className=b.className||"alert";var a="class ='"+(b.buttonClass?b.buttonClass+" ":"")+" ok_button'";c="      <div class='"+b.className+"_message'>"+c+"</div>        <div class='"+b.className+"_buttons'>          <input type='button' value='"+d+"' onclick='Dialog.okCallback()' "+a+"/>        </div>";Dialog.focusBtnIndex=0;return this._openDialog(c,b)},info:function(b,a){if(b&&typeof b!="string"){Dialog._runAjaxRequest(b,a,Dialog.info);return}b=b||"";a=a||{};a=Object.extend(a,a.windowParameters||{});a.windowParameters=a.windowParameters||{};a.className=a.className||"alert";b="<div id='modal_dialog_message' class='"+a.className+"_message'>"+b+"</div>";if(a.showProgress){b+="<div id='modal_dialog_progress' class='"+a.className+"_progress'>  </div>"}a.ok=null;a.cancel=null;return this._openDialog(b,a)},setInfoMessage:function(a){$("modal_dialog_message").update(a)},closeInfo:function(){Windows.close(this.dialogId)},_openDialog:function(e,d){var c=d.className;if(!d.height&&!d.width){d.width=WindowUtilities.getPageSize(d.options.parent||document.body).pageWidth/2}if(d.id){this.dialogId=d.id}else{var b=new Date();this.dialogId="modal_dialog_"+b.getTime();d.id=this.dialogId}if(!d.height||!d.width){var a=WindowUtilities._computeSize(e,this.dialogId,d.width,d.height,5,c);if(d.height){d.width=a+5}else{d.height=a+5}}d.resizable=d.resizable||false;d.minimizable=d.minimizable||false;d.maximizable=d.maximizable||false;d.draggable=d.draggable||false;d.closable=d.closable||false;var f=new Window(d);f.getContent().innerHTML=e;f.showCenter(true,d.top,d.left);f.setDestroyOnClose();f.cancelCallback=d.onCancel||d.cancel;f.okCallback=d.onOk||d.ok;return f},_getAjaxContent:function(a){Dialog.callFunc(a.responseText,Dialog.parameters)},_runAjaxRequest:function(c,b,a){if(c.options==null){c.options={}}Dialog.onCompleteFunc=c.options.onComplete;Dialog.parameters=b;Dialog.callFunc=a;c.options.onComplete=Dialog._getAjaxContent;new Ajax.Request(c.url,c.options)},okCallback:function(){var a=Windows.focusedWindow;if(!a.okCallback||a.okCallback(a)){$$("#"+a.getId()+" input").each(function(b){b.onclick=null});a.close()}},cancelCallback:function(){var a=Windows.focusedWindow;$$("#"+a.getId()+" input").each(function(b){b.onclick=null});a.close();if(a.cancelCallback){a.cancelCallback(a)}},_getBtnGroup:function(d){if($(d)){var b,c=[];if($(d).select('[type="button"]').length>0){b=$(d).select('[type="button"]')}else{if($(d).select(".edit_box_popup_actions a").length>0){b=$(d).select(".edit_box_popup_actions a")}else{if($(d).select(".group-btns a").length>0){b=$(d).select(".group-btns a")}else{b=$(d).select(".toolbar-buttons a")}}}b.each(function(a){if(a.visible()&&a.disabled!=true){c.push(a)}});return c}},getBtnCount:function(){var a=Dialog._getBtnGroup(Dialog.dialogId||(Windows.focusedWindow&&Windows.focusedWindow.getId()));if(a){return a.size()}},_focusBtn:function(b){var a=Dialog._getBtnGroup(b);if(Gcc.enableBtnAutoFocus&&a){a.each(function(e,c){if(e.disabled||!e.visible()||!e.up().visible()){Dialog.focusBtnIndex++;return}if(c==Dialog.focusBtnIndex){try{setTimeout(function(){if(Windows.windows.length>0){e.focus()}},180)}catch(d){}}})}Windows.focusBtnIndex=null},focusNext:function(){Dialog.focusBtnIndex++;if(Dialog.focusBtnIndex+1>Dialog.getBtnCount()){Dialog.focusBtnIndex=0}if(!Gcc.isTabKey){Dialog._focusBtn(Dialog.dialogId||(Windows.focusedWindow&&Windows.focusedWindow.getId()))}else{if(Dialog.focusBtnIndex==0){try{setTimeout(function(){var b=$(Windows.focusedWindow.getId()).select("form")[0];if(b){b.focusFirstCycleElement()}},180)}catch(a){}}}},focusPrev:function(){Dialog.focusBtnIndex--;if(Dialog.focusBtnIndex<0){Dialog.focusBtnIndex=Dialog.getBtnCount()-1}if(!Gcc.isShiftTabKey){Dialog._focusBtn(Dialog.dialogId||(Windows.focusedWindow&&Windows.focusedWindow.getId()))}else{var a=$(Windows.focusedWindow.getId()).select("form")[0];if(a){if(document.activeElement==a.findFirstCycleElement()){Dialog.focusBtnIndex=Dialog.getBtnCount()-1;Dialog._focusBtn(Dialog.dialogId||(Windows.focusedWindow&&Windows.focusedWindow.getId()))}}}}};if(Prototype.Browser.WebKit){var array=navigator.userAgent.match(new RegExp(/AppleWebKit\/([\d\.\+]*)/));Prototype.Browser.WebKitVersion=parseFloat(array[1])}var WindowUtilities={getWindowScroll:function(parent){var T,L,W,H;parent=parent||document.body;if(parent!=document.body){T=parent.scrollTop;L=parent.scrollLeft;W=parent.scrollWidth;H=parent.scrollHeight}else{var w=window;with(w.document){if(w.document.documentElement&&documentElement.scrollTop){T=documentElement.scrollTop;L=documentElement.scrollLeft}else{if(w.document.body){T=body.scrollTop;L=body.scrollLeft}}if(w.innerWidth){W=w.innerWidth;H=w.innerHeight}else{if(w.document.documentElement&&documentElement.clientWidth){W=documentElement.clientWidth;H=documentElement.clientHeight}else{W=body.offsetWidth;H=body.offsetHeight}}}}return{top:T,left:L,width:W,height:H}},getPageSize:function(d){d=d||document.body;var c,g;var e,b;if(d!=document.body){c=d.getWidth();g=d.getHeight();b=d.scrollWidth;e=d.scrollHeight}else{var f,a;if(window.innerHeight&&window.scrollMaxY){f=document.body.scrollWidth;a=window.innerHeight+window.scrollMaxY}else{if(document.body.scrollHeight>document.body.offsetHeight){f=document.body.scrollWidth;a=document.body.scrollHeight}else{f=document.body.offsetWidth;a=document.body.offsetHeight}}if(self.innerHeight){c=self.innerWidth;g=self.innerHeight}else{if(document.documentElement&&document.documentElement.clientHeight){c=document.documentElement.clientWidth;g=document.documentElement.clientHeight}else{if(document.body){c=document.body.clientWidth;g=document.body.clientHeight}}}if(a<g){e=g}else{e=a}if(f<c){b=c}else{b=f}}return{pageWidth:b,pageHeight:e,windowWidth:c,windowHeight:g}},disableScreen:function(c,a,d,e,b){WindowUtilities.initLightbox(a,c,function(){this._disableScreen(c,a,d,e)}.bind(this),b||document.body)},_disableScreen:function(c,b,e,f){var d=$(b);var a=WindowUtilities.getPageSize(d.parentNode);if(f&&Prototype.Browser.IE){WindowUtilities._hideSelect();WindowUtilities._showSelect(f)}d.style.height=a.pageHeight-9+"px";d.style.display="none";if(b=="overlay_modal"&&Window.hasEffectLib&&Windows.overlayShowEffectOptions){d.overlayOpacity=e;new Effect.Appear(d,Object.extend({from:0,to:e},Windows.overlayShowEffectOptions))}else{d.style.display="block"}},enableScreen:function(b){b=b||"overlay_modal";var a=$(b);if(a){if(b=="overlay_modal"&&Window.hasEffectLib&&Windows.overlayHideEffectOptions){new Effect.Fade(a,Object.extend({from:a.overlayOpacity,to:0},Windows.overlayHideEffectOptions))}else{a.style.display="none";a.parentNode.removeChild(a)}if(b!="__invisible__"){WindowUtilities._showSelect()}}},_hideSelect:function(a){if(Prototype.Browser.IE&&navigator.userAgent.toLowerCase().indexOf("msie 6")>-1){a=a==null?"":"#"+a+" ";$$(a+"select").each(function(b){if(!WindowUtilities.isDefined(b.oldVisibility)){b.oldVisibility=b.style.visibility?b.style.visibility:"visible";b.style.visibility="hidden"}})}},_showSelect:function(a){if(Prototype.Browser.IE&&navigator.userAgent.toLowerCase().indexOf("msie 6")>-1){a=a==null?"":"#"+a+" ";$$(a+"select").each(function(b){if(WindowUtilities.isDefined(b.oldVisibility)){try{b.style.visibility=b.oldVisibility}catch(c){b.style.visibility="visible"}b.oldVisibility=null}else{if(b.style.visibility){b.style.visibility="visible"}}})}},isDefined:function(a){return typeof(a)!="undefined"&&a!=null},initLightbox:function(e,c,a,b){if($(e)){Element.setStyle(e,{zIndex:Windows.maxZIndex+1});Windows.maxZIndex++;a()}else{var d=document.createElement("div");d.setAttribute("id",e);d.className="overlay_"+c;d.style.display="none";d.style.position="absolute";d.style.top="0";d.style.left="0";d.style.zIndex=Windows.maxZIndex+1;Windows.maxZIndex++;d.style.width="100%";b.insertBefore(d,b.firstChild);if(Prototype.Browser.WebKit&&e=="overlay_modal"){setTimeout(function(){a()},10)}else{a()}}},setCookie:function(b,a){document.cookie=a[0]+"="+escape(b)+((a[1])?"; expires="+a[1].toGMTString():"")+((a[2])?"; path="+a[2]:"")+((a[3])?"; domain="+a[3]:"")+((a[4])?"; secure":"")},getCookie:function(c){var b=document.cookie;var e=c+"=";var d=b.indexOf("; "+e);if(d==-1){d=b.indexOf(e);if(d!=0){return null}}else{d+=2}var a=document.cookie.indexOf(";",d);if(a==-1){a=b.length}return unescape(b.substring(d+e.length,a))},_computeSize:function(e,a,b,g,d,f){var i=document.body;var c=document.createElement("div");c.setAttribute("id",a);c.className=f+"_content";if(g){c.style.height=g+"px"}else{c.style.width=b+"px"}c.style.position="absolute";c.style.top="0";c.style.left="0";c.style.display="none";c.innerHTML=e;i.insertBefore(c,i.firstChild);var h;if(g){h=$(c).getDimensions().width+d}else{h=$(c).getDimensions().height+d}i.removeChild(c);return h}};WindowStore={doSetCookie:false,cookieName:"__window_store__",expired:null,init:function(d,b){WindowStore.cookieName=d||WindowStore.cookieName;if(!b){var a=new Date();a.setYear(a.getYear()+1903);WindowStore.expired=a}else{WindowStore.expired=b}Windows.windows.each(function(e){e.setCookie(e.getId(),WindowStore.expired)});var c={onShow:function(e,f){WindowStore._saveCookie()},onClose:function(e,f){WindowStore._saveCookie()},onHide:function(e,f){WindowStore._saveCookie()}};Windows.addObserver(c);WindowStore._restoreWindows();WindowStore._saveCookie()},show:function(win){eval("var cookie = "+WindowUtilities.getCookie(WindowStore.cookieName));if(cookie!=null){if(cookie[win.getId()]){win.show()}}else{win.show()}},_saveCookie:function(){if(!doSetCookie){return}var a="{";Windows.windows.each(function(b){if(a!="{"){a+=","}a+=b.getId()+": "+b.isVisible()});a+="}";WindowUtilities.setCookie(a,[WindowStore.cookieName,WindowStore.expired])},_restoreWindows:function(){eval("var cookie = "+WindowUtilities.getCookie(WindowStore.cookieName));if(cookie!=null){doSetCookie=false;Windows.windows.each(function(win){if(cookie[win.getId()]){win.show()}})}doSetCookie=true}};WindowCloseKey={keyCode:Event.KEY_ESC,init:function(a){if(a){WindowCloseKey.keyCode=a}Event.observe(document,"keydown",this._closeCurrentWindow.bindAsEventListener(this))},_closeCurrentWindow:function(a){if(!Windows.getFocusedWindow()){return}var c=Event.element(a);if((a.ctrlKey||a.shiftKey)&&c.match("select")){return}var i=a||window.event;var b=i.which||i.keyCode;try{var g=top.Windows.focusedWindow;if(b==WindowCloseKey.keyCode&&g){if(g.cancelCallback){top.Dialog.cancelCallback()}else{if(!Dialog.dialogId||Dialog.getBtnCount()>1){top.Windows.close(top.Windows.focusedWindow.getId())}}}var h=Event.findElement(a,"input");var f=Event.findElement(a,"select");var j=Event.findElement(a,"textarea");var d=Event.element(a).up(".edit_box_popup_actions")||Event.element(a).up(".group-btns")||Event.element(a).up(".toolbar-buttons")||Event.element(a).up(".demeter_buttons");if(b==39||b==40||(!i.shiftKey&&b==9)){Gcc.isTabKey=(!i.shiftKey&&b==9);if((!h&&!f&&!j)||(h&&h.type=="button")){if(d){top.Dialog.focusNext()}else{Dialog.focusBtnIndex=0}}}if(b==37||b==38||(i.shiftKey&&b==9)){Gcc.isShiftTabKey=(i.shiftKey&&b==9);if(Gcc.isShiftTabKey||(!h&&!f&&!j)||(h&&h.type=="button")){top.Dialog.focusPrev()}}}catch(i){}}};
if(typeof Prototype=="undefined"){throw"Unable to load Gcc UI lib, Prototype JS Framework not found!"}Ajax.getTransport=function(){return Try.these(function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new IFrameRequest()},function(){alert("GenMC error : the browser do not allow access to XMLHTTPRequest Object")})||false};Element.addMethods({remove:function(a){a=$(a);if(a.parentNode){a.parentNode.removeChild(a)}return a},cumulativeOffset:function(b){var a=0,c=0;do{a+=b.offsetTop||0;c+=b.offsetLeft||0;b=b.offsetParent;if(b==document.body){c-=document.body.offsetLeft;a-=document.body.offsetTop}}while(b);return Element._returnOffset(c,a)},clonePosition:function(b,d){var a=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},arguments[2]||{});d=$(d);var e=Element.viewportOffset(d);b=$(b);var f=[0,0];var c=null;if(Element.getStyle(b,"position")=="absolute"){c=Element.getOffsetParent(b);f=Element.viewportOffset(c)}if(c==document.body&&!Prototype.Browser.IE){f[0]-=document.body.offsetLeft;f[1]-=document.body.offsetTop}if(a.setLeft){b.style.left=(e[0]-f[0]+a.offsetLeft)+"px"}if(a.setTop){b.style.top=(e[1]-f[1]+a.offsetTop)+"px"}if(a.setWidth){b.style.width=d.offsetWidth+"px"}if(a.setHeight){b.style.height=d.offsetHeight+"px"}return b},findFirstCycleElement:function(b){var c=$(b).getElements().findAll(function(d){var e=$(d).up("div.edit_box_section")||$(d).up("div.popup-section");if(e){return"hidden"!=d.type&&!d.disabled&&d.visible()&&e.visible()}else{return"hidden"!=d.type&&!d.disabled&&d.visible()}});var a=c.findAll(function(d){return d.hasAttribute("tabIndex")&&d.tabIndex>=0}).sortBy(function(d){return d.tabIndex}).first();return a?a:c.find(function(d){return["input","select","textarea"].include(d.tagName.toLowerCase())})},focusFirstCycleElement:function(a){a=$(a);a.findFirstCycleElement().activate();return a}});Event.fire=function(e,c,b,a){e=$(e);if(Object.isUndefined(a)){a=true}if(e==document&&document.createEvent&&!e.dispatchEvent){e=document.documentElement}var f;if(document.createEvent){f=document.createEvent("HTMLEvents");f.initEvent("dataavailable",true,true)}else{f=document.createEventObject();f.eventType=a?"ondataavailable":"onfilterchange"}f.eventName=c;f.memo=b||{};try{if(document.createEvent){e.dispatchEvent(f)}else{e.fireEvent(f.eventType,f)}}catch(d){}return Event.extend(f)};if(typeof WindowCloseKey!="undefined"){WindowCloseKey.init()}if(typeof Window!="undefined"){Window.keepMultiModalWindow=true}if(typeof Gcc=="undefined"||!Gcc){var Gcc={baseURL:(typeof baseURL!="undefined"?baseURL:location.protocol+"//"+location.host),webContext:(typeof webContext!="undefined"?webContext:"..")}}Gcc.apply=function(b,d){if(b&&d&&typeof d=="object"){for(var a in d){b[a]=d[a]}}return b};(function(){var b=navigator.userAgent.toLowerCase(),d=function(e){return e.test(b)},f=Prototype.Browser.IE,i=f&&d(/msie 6/),h=f&&d(/msie 7/),g=!!window.XDomainRequest,c=Prototype.Browser.Gecko,a=c&&d(/rv:1\.9/),j=Prototype.Browser.WebKit,l=/^https/i.test(window.location.protocol);if(i){try{document.execCommand("BackgroundImageCache",false,true)}catch(k){}}Gcc.apply(Gcc,{BLANK_IMAGE_URL:Gcc.webContext+"/images/s.gif",locale:$H({}),platform:{},isTabKey:false,isShiftTabKey:false,showingModal:false,enableModalScrollbar:false,enableBtnAutoFocus:true});Gcc.apply(Gcc.platform,{isIE:f,isIE6:i,isIE7:h,isIE8:g,isGecko:c,isGecko3:a,isWebKit:j,isSecure:l});Gcc.isSecure=Gcc.platform.isSecure})();function loadRenderer(e,a,d){var c={method:d&&d.method||"post",requestHeaders:d&&d.requestHeaders||["Cache-Control","no-cache","If-Modified-Since","0"],asynchronous:d&&d.hasOwnProperty("asynchronous")?d.asynchronous:true,evalScripts:d&&d.hasOwnProperty("evalScripts")?d.evalScripts:true,parameters:d&&d.hasOwnProperty("parameters")?d.parameters:"",onLoading:d&&d.hasOwnProperty("onLoading")?d.onLoading:loading,onComplete:d&&d.onComplete||null,onSuccess:d&&d.onSuccess||successResults,onFailure:d&&d.onFailure||failureResults,onException:d&&d.onException||failureResults},b=Gcc.webContext+a;if(typeof e=="string"){e=e.replace(/#/g,"")}if($(e)){new Ajax.Updater(e,b,c)}else{new Ajax.Request(b,c)}}function successResults(){setTimeout("Gcc.closeInfo();",300);Gcc.locale.set("loadingText",Gcc.locale.get("loadingInfo"))}function failureResults(){setTimeout("Gcc.closeInfo();",300);location.href=Gcc.baseURL+Gcc.webContext+"/modaccess.do?action=login"}function loading(){Gcc.showInfo({info:Gcc.locale.get("loadingText")})}Gcc.ajax=loadRenderer;function fnShowAlert(a,e,b){Gcc.showingModal=true;var c=b&&b.iconClass||"ico_info";var f=['<div class="msg_container">','<div class="msg_content '+c+'">{Content}</div>',"</div>"].join("");function d(i,l,h){Dialog.alert(i,{title:h&&h.title||"System Alert",className:"demeter",buttonClass:"btn_alert",width:h&&h.width||300,draggable:h&&h.hasOwnProperty("draggable")?h.draggable:true,closable:h&&h.hasOwnProperty("closable")?h.closable:true,okLabel:h&&h.okLabel||Gcc.locale.get("okText"),showEffect:Element.show,hideEffect:Element.hide,recenterAuto:false,destroyOnClose:true,ok:l});Windows.getWindow(Dialog.dialogId).setConstraint(true);if(h&&h.closeCallback){Windows.getWindow(Dialog.dialogId).setCloseCallback(h.closeCallback)}var j=$(Dialog.dialogId+"_close");if(j){j.title=h&&h.closeTooltip||Gcc.locale.get("closeText")}var k=$(Dialog.dialogId+"_content");if(k){var g=k.select(".demeter_buttons input");var m=g[0];if(m){m.title=h&&h.okTooltip||Gcc.locale.get("okText")}}}d(f.replace("{Content}",a),e,b)}function fnShowConfirm(a,e,b,c){Gcc.showingModal=true;var d=c&&c.iconClass||"ico_question";var f=['<div class="msg_container">','<div class="msg_content '+d+'">{Content}</div>',"</div>"].join("");function g(m,h,j,p){if(p&&p.hasOwnProperty("focusBtnIndex")){Windows.focusBtnIndex=p.focusBtnIndex}Dialog.confirm(m,{title:p&&p.title||Gcc.locale.get("confimTitle"),className:"demeter",buttonClass:"btn_alert",width:p&&p.width||300,draggable:p&&p.hasOwnProperty("draggable")?p.draggable:true,closable:p&&p.hasOwnProperty("closable")?p.closable:true,okLabel:p&&p.okLabel||Gcc.locale.get("yesText"),cancelLabel:p&&p.cancelLabel||Gcc.locale.get("noText"),showEffect:Element.show,hideEffect:Element.hide,recenterAuto:false,destroyOnClose:true,ok:h,cancel:j});Windows.getWindow(Dialog.dialogId).setConstraint(true);if(p&&p.closeCallback){Windows.getWindow(Dialog.dialogId).setCloseCallback(p.closeCallback)}var n=$(Dialog.dialogId+"_close");if(n){n.title=p&&p.closeTooltip||Gcc.locale.get("closeText")}var k=$(Dialog.dialogId+"_content");if(k){var l=k.select(".demeter_buttons input");var i=l[0];var o=l[1];if(i){i.title=p&&p.okTooltip||Gcc.locale.get("yesText")}if(o){o.title=p&&p.cancelTooltip||Gcc.locale.get("noText")}}}g(f.replace("{Content}",a),e,b,c)}var oWinForEdit;function fnShowWindowForEdit(d,b){if(typeof Window=="undefined"){throw"Unable to show Popup UI, Window utilities not found!"}Gcc.showingModal=true;var c=function(){oWinForEdit=new Window({title:b&&b.title||"Popup Window",className:b&&b.className||"demeter",width:b&&b.width||366,height:b&&b.height||300,wiredDrag:b&&b.hasOwnProperty("wiredDrag")?b.wiredDrag:true,resizable:b&&b.hasOwnProperty("resizable")?b.resizable:false,minimizable:b&&b.hasOwnProperty("minimizable")?b.minimizable:false,maximizable:b&&b.hasOwnProperty("maximizable")?b.maximizable:false,closable:b&&b.hasOwnProperty("closable")?b.closable:true,draggable:b&&b.hasOwnProperty("draggable")?b.draggable:true,showEffect:Element.show,hideEffect:Element.hide,recenterAuto:false,destroyOnClose:true});if(b&&b.hasOwnProperty("focusBtnIndex")){Windows.focusBtnIndex=b.focusBtnIndex}Dialog.focusBtnIndex=Windows.focusBtnIndex!=null?Windows.focusBtnIndex:0;oWinForEdit.toFront();oWinForEdit.setContent(d);oWinForEdit.showCenter(true);oWinForEdit.setConstraint(true);if(b&&b.closeCallback){oWinForEdit.setCloseCallback(b.closeCallback)}$(d).style.visibility="visible";Windows.updateFocusedWindow();var e=$(oWinForEdit.getId()+"_close");if(e){e.title=b&&b.closeTooltip||Gcc.locale.get("closeText")}};if(b&&b.delay){setTimeout(function(){c()},900)}else{c()}var a=$("overlay_modal");if(a&&!a.visible()){a.show()}}function fnHideWindowForEdit(){if(Windows.focusedWindow){Windows.focusedWindow.hide()}if(typeof oWinForEdit!="undefined"&&oWinForEdit){oWinForEdit.hide();oWinForEdit=null}}Gcc.showAlert=fnShowAlert;Gcc.showConfirm=fnShowConfirm;Gcc.showWindow=fnShowWindowForEdit;Gcc.hideWindow=fnCloseWindowForEdit;function fnCloseWindowForEdit(){if(Prototype.Browser.IE&&Gcc.showingModal){if(Windows.windows.length==1){Gcc.showingModal=false;var a=$("overlay_modal");if(a&&a.visible()){a.hide()}}}if(Windows.focusedWindow){Windows.close(Windows.focusedWindow.getId())}if(typeof oWinForEdit!="undefined"&&oWinForEdit){Windows.close(oWinForEdit.getId());oWinForEdit=null}}Gcc.closeWindow=fnCloseWindowForEdit;Gcc.showIframePopup=function(b){if(!$("create_popup")){$(document.body).insert({bottom:new Element("div",{id:"create_popup",style:"display: none"})})}var a={title:b&&b.title||"&#160;",width:b&&b.width||385,height:b&&b.height||535};Gcc.showWindow("create_popup",a);if($("create_popup_area")){$("create_popup_area").remove()}var d="javascript:false";if(b){d=b.hasOwnProperty("srcUrl")?b.srcUrl:(Gcc.baseURL+Gcc.webContext+b.uri)}var c=new Element("iframe",{id:"create_popup_area",width:"100%",height:a.height+"px",frameborder:"0",src:d});window.setTimeout(function(){$("create_popup").insert({top:c})},300)};Gcc.showInfo=function(a){Dialog.closeInfo();Dialog.info(Gcc.locale.get("loadingText"),{width:a&&a.width||296,height:a&&a.height||56});if(a&&a.info){Dialog.setInfoMessage(a.info)}};Gcc.closeInfo=function(){Dialog.closeInfo();Dialog.dialogId=null;if(!Gcc.showingModal){setTimeout(function(){var a=$("overlay_modal");if(a&&a.visible()&&!Gcc.showingModal){a.hide()}},800)}if(Windows.focusedWindow){Dialog._focusBtn(Windows.focusedWindow.getId())}};Gcc.errConfig={};Gcc.errConfig.index=0;Gcc.errChar=null;Gcc.showErrMsg=function(b,h,m){var k,g=Gcc.errConfig.index,i=Gcc.errConfig.insertEl,j=Gcc.errConfig.highlightEl,l=Gcc.errConfig.className,f=Gcc.errConfig.headerInfo,d=Gcc.errConfig.highlightLabel,c=$(document.body);var a=function(n){if(!n){return}n.addClassName(l?l:"errorinput")};if(!m){if(c.select("div.error-container").length==0){var e=['<div class="error-container">','<div class="clear"><img align="absmiddle" class="big-warning" src="'+Gcc.BLANK_IMAGE_URL+'" />{HeaderErrMsg}</div>',"</div>"].join("");if(g!=3){e="<tr><td>"+e+"</td></tr>";k=c.select("tr.listheading")[g]||c.select("div.mod-hd")[g]}else{k=h?$(h):c}k.insert({after:e.replace(/{HeaderErrMsg}/g,f?f:Gcc.locale.get("errMsgHeaderInfo"))})}}e=['<div class="errorlabel">','<img align="absmiddle" class="small-warning" src="'+Gcc.BLANK_IMAGE_URL+'" />{LabelErrMsg}',"</div>"].join("");if($(i)){$(i).insert({after:e.replace(/{LabelErrMsg}/g,b)});if(j){if(j instanceof Array){j.each(function(n){a($(n))})}else{j=$(j);a(j)}}else{j=$(i);a(j)}}if(d){if(d instanceof Array){d.each(function(n){$(n).addClassName("error-text")})}else{if($(d)){$(d).addClassName("error-text")}}}Gcc.autoAdjustPopup()};Gcc.clearErrMsg=function(a){var b=$(a)?$(a):$(document.body);b.select("div.error-container").each(function(c){var d=Gcc.errConfig.index!=3?c.parentNode.parentNode:c;if($(d)){$(d).remove()}});b.select("div.errorlabel").each(Element.remove);b.select(".error-text",".errorinput",".errorlabel").each(function(c){var d=$(c);if(d){d.removeClassName("error-text");d.removeClassName("errorlabel");d.removeClassName("errorinput")}});Gcc.autoAdjustPopup()};Gcc.autoAdjustPopup=function(a){if(typeof Windows!="undefined"&&Windows.focusedWindow){Windows.focusedWindow.updateHeight();if(a===true){Windows.focusedWindow._center()}}};Gcc.setOverflow=function(a){$$(a).each(function(c){c.setStyle({width:"1px",overflow:"hidden",whiteSpace:"nowrap"});var b=c.up().getWidth();c.setStyle({width:b+"px"})})};Gcc.setTooltip=function(c){var a=$(c);var b=$(c+"_hover");if(a&&b){a.stopObserving();b.stopObserving();b.observe("mouseover",function(){b.show()});b.observe("mouseout",function(){b.hide()});a.observe("mouseover",function(){var d=a.cumulativeOffset();b.setStyle({top:d[1]+"px",left:d[0]+"px"});b.show()});a.observe("mouseout",function(){b.hide()})}};Gcc.setLinkActivation=function(e,c){var b=$(e);if(b){var a=b.innerHTML.replace("$A_LINK",'<a class="click-here" href="#">').replace("$A_LINK_END","</a>");b.update(a);var d=b.down("a.click-here");if(d){d.stopObserving("click");d.observe("click",c)}}};Gcc.setImagePreview=function(c){var b=c.url,e=new Image(),d=$(c.imageEl),a=Gcc.locale.get("IMAGE_PREVIEW")+" "+c.title;Gcc.showWindow(c.renderTo,{title:'<span class="preview-title" title="'+a+'">'+a+"</span>",width:c.width,height:c.height});loading();if(Gcc.isSecure){b=b.replace("http:","https:")}e.onload=function(){this.onload=null;var i,j=c.scaleWidth||202,g=c.scaleHeight||135,h=e.width,f=e.height;if((h>j)||(f>g)){if(h>f){i=h/f;e.width=j;e.height=j/i}else{i=f/h;e.height=g;e.width=g/i}}d.width=e.width;d.height=e.height;d.src=b;d.stopObserving("click");d.observe("click",function(){window.open(b,"_blank")});setTimeout(function(){Windows.focusedWindow.setSize(c.width,$(c.renderTo).getHeight())},600);successResults();return true};e.src=b};Gcc.setSlidesPreview=function(s){var h=s.xmlDoc,u=Gcc.locale.get("PUBLISHED_PPT_PREVIEW")+" "+s.title;if(!h){return}Gcc.showWindow(s.renderTo,{title:'<span class="preview-title" title="'+u+'">'+u+"</span>",width:s.width,height:s.height});var p,q,j=0,e="preview",l="",f=[],d=[],t=$("slide_display"),g=$("slide_title"),b=$("btn_prev_slide"),c=$("btn_next_slide"),n=$(s.nameEl),k=s.url,a=k.substring(0,k.lastIndexOf("/")),o=a+"/"+e+"/";for(p=0,q=h.childNodes.length;p<q;p++){var r=h.childNodes[p];if(r.nodeType!=3&&r.tagName.toLowerCase()=="slide"){f.push(r)}}for(p=0,q=f.length;p<q;p++){var m=f[p];d.push({slideTitle:m.getAttribute("title"),imageName:o+"Slide_"+(p+1)+".png"})}n.update(s.name);l="Slide1: "+d[0]["slideTitle"];t.src=d[0]["imageName"];t.title=l;g.update(l);if(c){c.stopObserving("click");c.observe("click",function(){j++;if(j>d.length-1){j=0}t.src=d[j]["imageName"];l="Slide"+(j+1)+": "+d[j]["slideTitle"];t.title=l;g.update(l)})}if(b){b.stopObserving("click");b.observe("click",function(){j--;if(j<0){j=d.length-1}t.src=d[j]["imageName"];l="Slide"+(j+1)+": "+d[j]["slideTitle"];t.title=l;g.update(l)})}};Gcc.setCharCount=function(f,b,a){var d=$(f);var c=function(){var k=$(b),i=d.value,g="",p=0,l=0,m=i.length,h=a;if(Prototype.Browser.Gecko){i.scan("\n",function(){p++})}var j=a-p;if(m<=j){h=j-m}else{g=i.substring(j);g.scan("\n",function(){l++});h=0;var o=j+(Prototype.Browser.Gecko?2*l:l);if(o>a){if(o==a+1){if(i.endsWith("\n")){o=a}else{o=a-2;h=2}}else{o=a}}d.value=i.substring(0,o)}if(k){k.update("["+h+"]")}};c();var e=function(){setTimeout(function(){c()},200)};d.observe("keyup",c);d.observe(Prototype.Browser.Gecko?"input":"paste",e);d.observe("drop",e);d.observe("dragdrop",e)};Gcc.ComboBox=function(b,a){this.opt=a||{};this.opt.inputClass=this.opt.inputClass||"selectbox";this.opt.containerClass=this.opt.containerClass||"selectbox-wrapper";this.opt.hoverClass=this.opt.hoverClass||"current";this.opt.currentClass=this.opt.currentClass||"selected";this.opt.applyStyles=this.opt.applyStyles||null;this.opt.width=this.opt.width||200;this.opt.trim=this.opt.trim||20;this.opt.readOnly=(this.opt.readOnly!==false);this.opt.inputMaxLength=this.opt.inputMaxLength||null;this.opt.clickDropdown=this.opt.clickDropdown||null;this.select=$(b);this.container=null;this.input=null;this.useShim={initOnce:true,shim:null}};Gcc.ComboBox.prototype={active:-1,inFocus:false,hasfocus:0,init:function(){this.container=this.setupContainer();this.input=this.setupInput();$(document.body).insert({top:this.container});this.select.insert({before:this.input});this.select.hide();this.reloadOptions();if(this.opt.applyStyles){this.input.setStyle(this.opt.applyStyles)}this.input.setStyle({width:this.opt.width-16+"px"});this.container.setStyle({width:this.opt.width+"px"});this.addEvents();if(Gcc.platform.isIE6){this.useShim.shim=this.createShim()}},setupContainer:function(){var b=this.select.identify()+"_container";if($(b)){$(b).remove()}var a=document.createElement("div");this.container=$(a);this.container.id=b;this.container.addClassName(this.opt.containerClass);this.container.setStyle({overflow:"hidden"});this.container.hide();return this.container},setupInput:function(){var a=document.createElement("input");this.input=$(a);this.input.id=this.select.identify()+"_input";if($(this.input.id)){$(this.input.id).remove()}this.input.writeAttribute("type","text");this.input.addClassName(this.opt.inputClass);this.input.writeAttribute("autocomplete","off");if(this.opt.readOnly){this.input.writeAttribute("readonly","readonly")}else{if(this.opt.inputMaxLength){this.input.writeAttribute("maxLength",this.opt.inputMaxLength)}}if(this.select.tabIndex){this.input.writeAttribute("tabIndex",this.select.tabIndex)}return this.input},createShim:function(){var a=document.createElement("iframe");a.src="javascript:false";a.frameBorder=0;a.className="use-shim";return $(a)},addEvents:function(){var a=this;this.container.observe("mouseover",function(){a.hasfocus=1});this.container.observe("mouseout",function(){a.hasfocus=-1;if(Prototype.Browser.IE){a.input.focus()}});this.input.observe("mouseover",function(){a.input.addClassName("combo-hover")});this.input.observe("mouseout",function(){a.input.removeClassName("combo-hover")});this.input.observe("click",function(){var b=a.input.cumulativeOffset();var f=a.input.cumulativeScrollOffset();a.container.setStyle({left:b[0]-f[0]+1+"px",top:b[1]-f[1]+20+"px"});if(Gcc.platform.isIE6){if(a.useShim.initOnce){a.useShim.initOnce=false;a.container.insert({after:a.useShim.shim})}var e=a.container.childElements()[0].childElements().length*19-10;if(a.opt.dropdownHeight&&e>a.opt.dropdownHeight){e=a.opt.dropdownHeight}a.useShim.shim.setStyle({left:a.container.getStyle("left"),top:a.container.getStyle("top"),width:a.container.getStyle("width"),height:e+"px",zIndex:a.container.getStyle("z-index")-2,visibility:"visible"})}a.container.toggle();if(!a.container.visible()){a.hideList()}else{var d=a.container.select("li."+a.opt.currentClass)[0];if(d){d.removeClassName(a.opt.currentClass)}var c=a.select.selectedIndex;a.container.select("li")[c].addClassName(a.opt.currentClass);setTimeout(function(){a.container.scrollTop=c*15},100)}});this.input.observe("focus",function(){if(a.container.visible()){a.inFocus=true;a.container.show()}});this.input.observe("keydown",function(c){switch(c.keyCode){case 38:c.preventDefault();a.moveSelect(-1);break;case 40:c.preventDefault();a.moveSelect(1);break;case 13:c.preventDefault();a.container.select("li."+a.opt.currentClass).each(function(d){d.removeClassName(a.opt.currentClass)});var b=$(a.container.select("li."+a.opt.hoverClass)[0]);if(b){b.removeClassName(a.opt.hoverClass);b.addClassName(a.opt.currentClass);a.setCurrSelect()}a.hideList();break;case 27:a.hideList();break}});this.input.observe("blur",function(){if(!(a.container.visible()&&a.hasfocus>0)){a.hideList()}})},moveSelect:function(c){var b=this;var a=this.container.select("li");if(!a){return}this.active+=c;if(this.active<0){this.active=0}else{if(this.active>=a.size()){this.active=a.size()-1}}a.each(function(d){d.removeClassName(b.opt.hoverClass)});$(a[this.active]).addClassName(this.opt.hoverClass)},setCurrSelect:function(){var b=this.container.select("li."+this.opt.currentClass)[0];var a=b.id.split("_");this.select.value=a[a.length-1];if(typeof this.select.onchange=="function"){this.select.onchange()}this.input.value=$(b).title.truncate(this.opt.trim);this.input.title=$(b).title;return true},hideList:function(){this.hasfocus=0;this.container.hide();if(Gcc.platform.isIE6){this.useShim.shim.style.visibility="hidden";$$(".use-shim").each(function(a){if(a){a.style.visibility="hidden"}})}},getOptions:function(c){var a=document.createElement("ul");var b=this;this.select.childElements().each(function(e){var d=document.createElement("li");d.id=c+"_"+e.value;d.title=e.text;d.appendChild(document.createTextNode(e.text));if(e.selected){b.input.value=e.text.truncate(b.opt.trim);b.input.title=e.text}a.appendChild(d);var f=$(d);f.observe("mouseover",function(h){var g=h.element();b.hasfocus=1;g.addClassName(b.opt.hoverClass);b.input.addClassName("combo-hover")});f.observe("mouseout",function(h){var g=h.element();b.hasfocus=-1;g.removeClassName(b.opt.hoverClass);b.input.removeClassName("combo-hover")});f.observe("click",function(h){var g=h.element();b.container.select("li."+b.opt.currentClass).each(function(i){i.removeClassName(b.opt.currentClass)});g.addClassName(b.opt.currentClass);b.setCurrSelect();if(typeof b.opt.clickDropdown=="function"){b.opt.clickDropdown()}b.hideList()})});if(this.select.selectedIndex==0){this.input.value=this.select.options[0].text.truncate(this.opt.trim);this.input.title=this.select.options[0].text}return a},reloadOptions:function(){this.container.update("");this.container.appendChild(this.getOptions(this.input.id));this.adjustUI()},adjustUI:function(){var a=this,d=this.container.childElements()[0].childElements(),b=false,c=d.length*19;if(this.opt.dropdownHeight&&c>this.opt.dropdownHeight){b=true}d.each(function(e){var f=$(e);if(b){f.setStyle({width:a.opt.width-21+"px",whiteSpace:"nowrap",overflow:"hidden"})}else{f.setStyle({width:a.opt.width+"px",whiteSpace:"nowrap",overflow:"hidden"})}});if(b){this.container.setStyle({height:this.opt.dropdownHeight+"px",overflow:"auto"})}}};Gcc.apply(Date,{monthEnNames:["January","February","March","April","May","June","July","August","September","October","November","December"]});Gcc.DatePicker=function(a){this.opt=a||{};this.opt.currentDate=a.currentDate||new Date();this.opt.containerCls=a.containerCls||"cal-dropdown";this.opt.datepickerCls=a.datepickerCls||"datepicker";this.opt.disableRange=a.disableRange||false;this.opt.monthNames=a.months||Date.monthNames;this.opt.yearNames=a.years||[];this.opt.lang=a.language||"en";this.opt.langCodes=a.langCodes||[];this.opt.dayFormat=this.opt.langCodes.include(this.opt.lang)?("j"+Gcc.locale.get("DAY_ZS_JA")):"j";this.opt.yearFormat=this.opt.langCodes.include(this.opt.lang)?("Y"+Gcc.locale.get("YEAR_ZS_JA")):"Y";this.opt.disableDateDropdown=a.disableDateDropdown;this.opt.enableDateDropdown=a.enableDateDropdown;this.mode=(a.mode&&a.mode.toLowerCase())||"dropdown";this.buttons=null;this.datepicker=null;this.activeDate=null;this.triggerBtn=null;this.navDropdown=null;this.useShim={initOnce:true,shim:null}};Gcc.DatePicker.prototype={init:function(a){this.buttons=a;this.setLayoutView();this.addEvents();this.selectToday(this.opt.currentDate);if(Gcc.platform.isIE6){this.useShim.shim=this.createShim()}},setLayoutView:function(){this.navDropdown=new Element("div",{"class":this.opt.containerCls});this.navDropdown.hide();this.datepicker=new Element("div",{"class":this.opt.datepickerCls});this.datepicker.hide();this.datepicker.insert('<div class="dp-wrap"><div class="cal-nav-wrap"></div><div class="cal-nav-info"></div><div class="cal-pane-wrap"></div><div class="clear"></div></div>');this.setNavView();this.setPaneView();var a=$(document.body);a.insert({top:this.navDropdown});a.insert({top:this.datepicker})},setNavView:function(){var c=Gcc.locale.get("PREVIOUS_MONTH");var e=Gcc.locale.get("NEXT_MONTH");var d=Gcc.locale.get("SELECT_MONTH");var b=Gcc.locale.get("SELECT_YEAR");var a=Gcc.locale.get("TODAY");this.datepicker.down("div.cal-nav-wrap").insert('<div class="cal-nav"><ul><li class="arrow-wrap" title="'+c+'"><span class="arrow-lt"></span></li><li class="month-wrap" title="'+d+'"><div class="nav-month"></div><span class="arrow-down"></span></li><li class="year-wrap" title="'+b+'"><div class="nav-year"></div><span class="arrow-down"></span></li><li class="arrow-wrap" title="'+e+'"><span class="arrow-rt"></span></li></ul><div class="clear"></div></div>');this.datepicker.down("div.cal-nav-info").insert('<a href="#" title="'+a+'">'+a+"</a><span></span>")},setPaneView:function(){var f=Gcc.locale.get("SN"),e=Gcc.locale.get("M"),d=Gcc.locale.get("T"),c=Gcc.locale.get("W"),a=Gcc.locale.get("TH"),h=Gcc.locale.get("F"),g=Gcc.locale.get("S"),b=Gcc.locale.get("CLOSE");this.datepicker.down("div.cal-pane-wrap").insert('<ul class="cal-pane-hd"><li>'+f+"</li><li>"+e+"</li><li>"+d+"</li><li>"+c+"</li><li>"+a+"</li><li>"+h+"</li><li>"+g+'</li></ul><div class="cal-pane-bd"></div><div class="cal-pane-ft"><a href="#" title="'+b+'" class="btn-small-close">'+b+"</a></div>");this.onRenderPaneView()},onRenderPaneView:function(){var d=this.datepicker.down("div.cal-pane-bd");d.update("");var b=['<table class="dp-grid"><tr>'];for(var c=0;c<42;c++){if(c%7==0&&c!=0){b.push("</tr><tr>")}b.push('<td><a hidefocus="on" href="#">&#160;</a></td>')}b.push("</tr></table>");d.update(b.join(""));this.cellDays=d.select("table.dp-grid td a")},onClickEvtDropdown:function(c,b,a){var d=this;c=$(c);c.observe("click",function(){if(d.timer){window.clearTimeout(d.timer)}d.setListDropdown(b,a);var e=c.cumulativeOffset();d.navDropdown.setStyle({left:e[0]+1+"px",top:e[1]+19+"px",width:c.getWidth()-2+"px",height:"auto"});d.navDropdown.show()})},onClickEvtListDropdown:function(b){var c=this;var a=$$(".cal-dropdown ul li a");a.each(function(d){if(!d.hasClassName("state-grey")){d.observe("click",function(){var e,f=d.firstChild.nodeValue;if(b=="year"){f=parseInt(f,10);e=f-c.activeDate.getFullYear();c.activeDate=c.activeDate.add("y",e)}else{e=Date.monthNumbers[d.readAttribute("monthitem").substring(0,3)]-(c.activeDate.format("n")-1);c.activeDate=c.activeDate.add("mo",e)}c.navDropdown.hide();c.enableNavButtonGroup();c.update(c.activeDate);c.selectActiveMonth();c.selectActiveYear()})}})},onMouseEvtDropdown:function(){var a=this;this.navDropdown.observe("mouseover",function(){a.navDropdown.show();if(a.timer){window.clearTimeout(a.timer)}});this.navDropdown.observe("mouseout",function(){a.timer=window.setTimeout(function(){a.navDropdown.hide()},800)})},setListDropdown:function(a,b){this.navDropdown.update("");var c=b=="year"?this.activeDate.format("Y"):this.activeDate.format("n");var f=0,e=this.opt.currentDate;if(this.opt.disableRange&&this.activeDate.getFullYear()==e.getFullYear()-1){f=e.getMonth()}var d=new Element("ul");a.each(function(h,g){var i,j,k="";if(b=="month"){i="month";i=g<f?i+" state-grey":i;k="monthitem="+Date.monthEnNames[g];j=(g==c-1)?' class="select-item"':""}else{i="year";j=(h==c)?' class="select-item"':""}d.insert("<li"+j+'><a class="'+i+'" href="#" '+k+' title="'+h+'">'+h+"</a></li>")});this.navDropdown.insert(d);this.onClickEvtListDropdown(b)},createShim:function(){var a=document.createElement("iframe");a.src="javascript:false";a.frameBorder=0;a.className="use-shim";return $(a)},closeDatePicker:function(){this.datepicker.hide();if(Gcc.platform.isIE6){this.useShim.shim.style.visibility="hidden"}if(typeof this.opt.enableDateDropdown=="function"){this.opt.enableDateDropdown()}},setNavButtonStatus:function(d,c){var b=this.datepicker.down("span.arrow-lt").up("li");var a=this.datepicker.down("span.arrow-rt").up("li");if(c=="enable"){if(d=="next"){a.removeClassName("state-grey")}else{b.removeClassName("state-grey")}}else{if(d=="next"){a.addClassName("state-grey")}else{b.addClassName("state-grey")}}},enableNavButtonGroup:function(){this.setNavButtonStatus("prev","enable");this.setNavButtonStatus("next","enable")},addEvents:function(){var c=this;var a=this.datepicker.down("li.month-wrap");var d=this.datepicker.down("li.year-wrap");this.onMouseEvtDropdown();this.onClickEvtDropdown(a,this.opt.monthNames,"month");this.onClickEvtDropdown(d,this.opt.yearNames,"year");var b=function(e){$(e).observe("click",function(){c.triggerBtn=this;var g=c.triggerBtn.previous(0);if(c.mode=="dropdown"){g=g.match("select")?g:g.down("select")}if(!g.disabled){var f=this.cumulativeOffset();c.datepicker.setStyle({left:f[0]-183+"px",top:f[1]+17+"px"});if(Gcc.platform.isIE6){if(c.useShim.initOnce){c.useShim.initOnce=false;c.datepicker.insert({after:c.useShim.shim})}c.useShim.shim.setStyle({left:c.datepicker.getStyle("left"),top:c.datepicker.getStyle("top"),width:c.datepicker.getStyle("width"),height:c.datepicker.getStyle("height"),zIndex:c.datepicker.getStyle("z-index")-2,visibility:"visible"})}c.selectToday(c.opt.currentDate);c.datepicker.show();if(typeof c.opt.disableDateDropdown=="function"){c.opt.disableDateDropdown()}}})};if(this.buttons instanceof Array){this.buttons.each(function(e){b(e)})}else{b(this.buttons)}this.datepicker.down("a.btn-small-close").observe("click",function(){c.closeDatePicker()});this.datepicker.down("div.cal-nav-info a").observe("click",function(){var e=c.opt.currentDate;c.pickDate(e.format("Y"),e.format("n"),e.format("j"))});this.datepicker.down("span.arrow-lt").up("li").observe("click",function(){c.showPrevMonth()});this.datepicker.down("span.arrow-rt").up("li").observe("click",function(){c.showNextMonth()});this.cellDays.each(function(e){e.observe("click",function(){var g=c.activeDate;if(e.hasClassName("prev-month")){g=g.add("mo",-1)}else{if(e.hasClassName("next-month")){g=g.add("mo",1)}}var i=g.format("Y");var f=g.format("n");var h=this.firstChild.nodeValue;c.pickDate(i,f,h)})});document.observe("keydown",function(e){if(e.keyCode==Event.KEY_ESC){if(this.datepicker.visible()){c.closeDatePicker()}}}.bind(this))},selectOption:function(b,a){b.select("option").each(function(c){if(c.value==a){c.selected=true}})},pickDate:function(g,a,e){var c=this.mode=="dropdown"?this.triggerBtn.previous(1):this.triggerBtn.previous(0);var f=a+"/"+e+"/"+g;if(this.mode=="dropdown"){var d=c.match("select")?c:c.down("select");var b=new Date(f);if(typeof fnInitScheduleDateDropdown=="function"){fnInitScheduleDateDropdown(b,d,"day")}this.selectOption(this.triggerBtn.previous(0),g);this.selectOption(this.triggerBtn.previous(2),a);this.selectOption(d,e)}else{if(this.mode=="textfield"){c.value=f}}this.closeDatePicker()},showPrevMonth:function(){var a=this.opt.disableRange&&(this.activeDate<=this.opt.currentDate.add("y",-1));if(!a){this.enableNavButtonGroup();this.activeDate=this.activeDate.add("mo",-1);this.update(this.activeDate);this.selectActiveMonth();this.selectActiveYear()}},showNextMonth:function(){var a=this.opt.yearNames;var b=this.opt.disableRange&&this.activeDate.getMonth()==11&&this.activeDate.getFullYear()==a[a.length-1];if(!b){this.enableNavButtonGroup();this.activeDate=this.activeDate.add("mo",1);this.update(this.activeDate);this.selectActiveMonth();this.selectActiveYear()}},selectActiveYear:function(){this.datepicker.down("div.nav-month").update(this.activeDate.format("F"))},selectActiveMonth:function(){this.datepicker.down("div.nav-year").update(this.activeDate.format("Y"))},selectToday:function(a){this.activeDate=a;if(this.datepicker){this.datepicker.down("div.nav-month").update(a.format("F"));this.datepicker.down("div.nav-year").update(a.format("Y"));var b=this.datepicker.down("div.cal-nav-info span");if(b.empty()){b.update(a.format("F "+this.opt.dayFormat+", "+this.opt.yearFormat))}}this.update(a)},update:function(c){var e=this.opt.currentDate;var l=c.getDaysInMonth();var h=c.getDate();var f=c.getFirstDateOfMonth().getDay();var k=c.add("mo",-1).getDaysInMonth()-f;var g,m,n=this.cellDays,b=0;if(!n){n=$$("table.dp-grid td a")}var d=0;for(;d<f;d++){g=++k;m=n[d];m.removeClassName("select-day");m.removeClassName("today");if(!m.hasClassName("prev-month")){m.addClassName("outside prev-month")}m.update(g);m.title=g}for(;d<f+l;d++){g=d-(f-1);m=n[d];m.removeClassName("outside");m.removeClassName("select-day");m.removeClassName("today");m.removeClassName("prev-month");m.removeClassName("next-month");m.update(g);m.title=g;if(g==h){m.addClassName("select-day");if(e.getMonth()==c.getMonth()&&e.getFullYear()==c.getFullYear()){m.addClassName("today")}}}for(;d<42;d++){g=++b;m=n[d];m.removeClassName("select-day");m.removeClassName("today");if(!m.hasClassName("next-month")){m.addClassName("outside next-month")}m.update(g);m.title=g}this.enableNavButtonGroup();if(this.opt.disableRange){var j=this.activeDate;if(j<=e.add("y",-1)){this.setNavButtonStatus("prev","disable")}var a=this.opt.yearNames;if(j.getMonth()==11&&j.getFullYear()==a[a.length-1]){this.setNavButtonStatus("next","disable")}}}};Gcc.locale.update({loadingText:"loading...",closeText:"close",okText:"ok",yesText:"yes",noText:"no",errMsgHeaderInfo:"One or more fields below may contain errors. Please review.",loadingInfo:"loading...",savingInfo:"saving..."});
if(typeof Prototype=="undefined"){throw"Unable to load Gcc UI lib, Prototype JS Framework not found!"}Ajax.getTransport=function(){return Try.these(function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new IFrameRequest()},function(){alert("GenMC error : the browser do not allow access to XMLHTTPRequest Object")})||false};Element.addMethods({remove:function(a){a=$(a);if(a.parentNode){a.parentNode.removeChild(a)}return a},cumulativeOffset:function(b){var a=0,c=0;do{a+=b.offsetTop||0;c+=b.offsetLeft||0;b=b.offsetParent;if(b==document.body){c-=document.body.offsetLeft;a-=document.body.offsetTop}}while(b);return Element._returnOffset(c,a)},clonePosition:function(b,d){var a=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},arguments[2]||{});d=$(d);var e=Element.viewportOffset(d);b=$(b);var f=[0,0];var c=null;if(Element.getStyle(b,"position")=="absolute"){c=Element.getOffsetParent(b);f=Element.viewportOffset(c)}if(c==document.body&&!Prototype.Browser.IE){f[0]-=document.body.offsetLeft;f[1]-=document.body.offsetTop}if(a.setLeft){b.style.left=(e[0]-f[0]+a.offsetLeft)+"px"}if(a.setTop){b.style.top=(e[1]-f[1]+a.offsetTop)+"px"}if(a.setWidth){b.style.width=d.offsetWidth+"px"}if(a.setHeight){b.style.height=d.offsetHeight+"px"}return b},findFirstCycleElement:function(b){var c=$(b).getElements().findAll(function(d){var e=$(d).up("div.edit_box_section")||$(d).up("div.popup-section");if(e){return"hidden"!=d.type&&!d.disabled&&d.visible()&&e.visible()}else{return"hidden"!=d.type&&!d.disabled&&d.visible()}});var a=c.findAll(function(d){return d.hasAttribute("tabIndex")&&d.tabIndex>=0}).sortBy(function(d){return d.tabIndex}).first();return a?a:c.find(function(d){return["input","select","textarea"].include(d.tagName.toLowerCase())})},focusFirstCycleElement:function(a){a=$(a);a.findFirstCycleElement().activate();return a}});Event.fire=function(e,c,b,a){e=$(e);if(Object.isUndefined(a)){a=true}if(e==document&&document.createEvent&&!e.dispatchEvent){e=document.documentElement}var f;if(document.createEvent){f=document.createEvent("HTMLEvents");f.initEvent("dataavailable",true,true)}else{f=document.createEventObject();f.eventType=a?"ondataavailable":"onfilterchange"}f.eventName=c;f.memo=b||{};try{if(document.createEvent){e.dispatchEvent(f)}else{e.fireEvent(f.eventType,f)}}catch(d){}return Event.extend(f)};if(typeof WindowCloseKey!="undefined"){WindowCloseKey.init()}if(typeof Window!="undefined"){Window.keepMultiModalWindow=true}if(typeof Gcc=="undefined"||!Gcc){var Gcc={baseURL:(typeof baseURL!="undefined"?baseURL:location.protocol+"//"+location.host),webContext:(typeof webContext!="undefined"?webContext:"..")}}Gcc.apply=function(b,d){if(b&&d&&typeof d=="object"){for(var a in d){b[a]=d[a]}}return b};(function(){var b=navigator.userAgent.toLowerCase(),d=function(e){return e.test(b)},f=Prototype.Browser.IE,i=f&&d(/msie 6/),h=f&&d(/msie 7/),g=!!window.XDomainRequest,c=Prototype.Browser.Gecko,a=c&&d(/rv:1\.9/),j=Prototype.Browser.WebKit,l=/^https/i.test(window.location.protocol);if(i){try{document.execCommand("BackgroundImageCache",false,true)}catch(k){}}Gcc.apply(Gcc,{BLANK_IMAGE_URL:Gcc.webContext+"/images/s.gif",locale:$H({}),platform:{},isTabKey:false,isShiftTabKey:false,showingModal:false,enableModalScrollbar:false,enableBtnAutoFocus:true});Gcc.apply(Gcc.platform,{isIE:f,isIE6:i,isIE7:h,isIE8:g,isGecko:c,isGecko3:a,isWebKit:j,isSecure:l});Gcc.isSecure=Gcc.platform.isSecure})();function loadRenderer(e,a,d){var c={method:d&&d.method||"post",requestHeaders:d&&d.requestHeaders||["Cache-Control","no-cache","If-Modified-Since","0"],asynchronous:d&&d.hasOwnProperty("asynchronous")?d.asynchronous:true,evalScripts:d&&d.hasOwnProperty("evalScripts")?d.evalScripts:true,parameters:d&&d.hasOwnProperty("parameters")?d.parameters:"",onLoading:d&&d.hasOwnProperty("onLoading")?d.onLoading:loading,onComplete:d&&d.onComplete||null,onSuccess:d&&d.onSuccess||successResults,onFailure:d&&d.onFailure||failureResults,onException:d&&d.onException||failureResults},b=Gcc.webContext+a;if(typeof e=="string"){e=e.replace(/#/g,"")}if($(e)){new Ajax.Updater(e,b,c)}else{new Ajax.Request(b,c)}}function successResults(){setTimeout("Gcc.closeInfo();",300);Gcc.locale.set("loadingText",Gcc.locale.get("loadingInfo"))}function failureResults(){setTimeout("Gcc.closeInfo();",300);location.href=Gcc.baseURL+Gcc.webContext+"/modaccess.do?action=login"}function loading(){Gcc.showInfo({info:Gcc.locale.get("loadingText")})}Gcc.ajax=loadRenderer;function fnShowAlert(a,e,b){Gcc.showingModal=true;var c=b&&b.iconClass||"ico_info";var f=['<div class="msg_container">','<div class="msg_content '+c+'">{Content}</div>',"</div>"].join("");function d(i,l,h){Dialog.alert(i,{title:h&&h.title||"System Alert",className:"demeter",buttonClass:"btn_alert",width:h&&h.width||300,draggable:h&&h.hasOwnProperty("draggable")?h.draggable:true,closable:h&&h.hasOwnProperty("closable")?h.closable:true,okLabel:h&&h.okLabel||Gcc.locale.get("okText"),showEffect:Element.show,hideEffect:Element.hide,recenterAuto:false,destroyOnClose:true,ok:l});Windows.getWindow(Dialog.dialogId).setConstraint(true);if(h&&h.closeCallback){Windows.getWindow(Dialog.dialogId).setCloseCallback(h.closeCallback)}var j=$(Dialog.dialogId+"_close");if(j){j.title=h&&h.closeTooltip||Gcc.locale.get("closeText")}var k=$(Dialog.dialogId+"_content");if(k){var g=k.select(".demeter_buttons input");var m=g[0];if(m){m.title=h&&h.okTooltip||Gcc.locale.get("okText")}}}d(f.replace("{Content}",a),e,b)}function fnShowConfirm(a,e,b,c){Gcc.showingModal=true;var d=c&&c.iconClass||"ico_question";var f=['<div class="msg_container">','<div class="msg_content '+d+'">{Content}</div>',"</div>"].join("");function g(m,h,j,p){if(p&&p.hasOwnProperty("focusBtnIndex")){Windows.focusBtnIndex=p.focusBtnIndex}Dialog.confirm(m,{title:p&&p.title||"System Confirm",className:"demeter",buttonClass:"btn_alert",width:p&&p.width||300,draggable:p&&p.hasOwnProperty("draggable")?p.draggable:true,closable:p&&p.hasOwnProperty("closable")?p.closable:true,okLabel:p&&p.okLabel||Gcc.locale.get("yesText"),cancelLabel:p&&p.cancelLabel||Gcc.locale.get("noText"),showEffect:Element.show,hideEffect:Element.hide,recenterAuto:false,destroyOnClose:true,ok:h,cancel:j});Windows.getWindow(Dialog.dialogId).setConstraint(true);if(p&&p.closeCallback){Windows.getWindow(Dialog.dialogId).setCloseCallback(p.closeCallback)}var n=$(Dialog.dialogId+"_close");if(n){n.title=p&&p.closeTooltip||Gcc.locale.get("closeText")}var k=$(Dialog.dialogId+"_content");if(k){var l=k.select(".demeter_buttons input");var i=l[0];var o=l[1];if(i){i.title=p&&p.okTooltip||Gcc.locale.get("yesText")}if(o){o.title=p&&p.cancelTooltip||Gcc.locale.get("noText")}}}g(f.replace("{Content}",a),e,b,c)}var oWinForEdit;function fnShowWindowForEdit(d,b){if(typeof Window=="undefined"){throw"Unable to show Popup UI, Window utilities not found!"}Gcc.showingModal=true;var c=function(){oWinForEdit=new Window({title:b&&b.title||"Popup Window",className:b&&b.className||"demeter",width:b&&b.width||366,height:b&&b.height||300,wiredDrag:b&&b.hasOwnProperty("wiredDrag")?b.wiredDrag:true,resizable:b&&b.hasOwnProperty("resizable")?b.resizable:false,minimizable:b&&b.hasOwnProperty("minimizable")?b.minimizable:false,maximizable:b&&b.hasOwnProperty("maximizable")?b.maximizable:false,closable:b&&b.hasOwnProperty("closable")?b.closable:true,draggable:b&&b.hasOwnProperty("draggable")?b.draggable:true,showEffect:Element.show,hideEffect:Element.hide,recenterAuto:false,destroyOnClose:true});if(b&&b.hasOwnProperty("focusBtnIndex")){Windows.focusBtnIndex=b.focusBtnIndex}Dialog.focusBtnIndex=Windows.focusBtnIndex!=null?Windows.focusBtnIndex:0;oWinForEdit.toFront();oWinForEdit.setContent(d);oWinForEdit.showCenter(true);oWinForEdit.setConstraint(true);if(b&&b.closeCallback){oWinForEdit.setCloseCallback(b.closeCallback)}$(d).style.visibility="visible";Windows.updateFocusedWindow();var e=$(oWinForEdit.getId()+"_close");if(e){e.title=b&&b.closeTooltip||Gcc.locale.get("closeText")}};if(b&&b.delay){setTimeout(function(){c()},900)}else{c()}var a=$("overlay_modal");if(a&&!a.visible()){a.show()}}function fnHideWindowForEdit(){if(Windows.focusedWindow){Windows.focusedWindow.hide()}if(typeof oWinForEdit!="undefined"&&oWinForEdit){oWinForEdit.hide();oWinForEdit=null}}Gcc.showAlert=fnShowAlert;Gcc.showConfirm=fnShowConfirm;Gcc.showWindow=fnShowWindowForEdit;Gcc.hideWindow=fnCloseWindowForEdit;function fnCloseWindowForEdit(){if(Prototype.Browser.IE&&Gcc.showingModal){if(Windows.windows.length==1){Gcc.showingModal=false;var a=$("overlay_modal");if(a&&a.visible()){a.hide()}}}if(Windows.focusedWindow){Windows.close(Windows.focusedWindow.getId())}if(typeof oWinForEdit!="undefined"&&oWinForEdit){Windows.close(oWinForEdit.getId());oWinForEdit=null}}Gcc.closeWindow=fnCloseWindowForEdit;Gcc.showIframePopup=function(b){if(!$("create_popup")){$(document.body).insert({bottom:new Element("div",{id:"create_popup",style:"display: none"})})}var a={title:b&&b.title||"&#160;",width:b&&b.width||385,height:b&&b.height||535};Gcc.showWindow("create_popup",a);if($("create_popup_area")){$("create_popup_area").remove()}var c=new Element("iframe",{id:"create_popup_area",width:"100%",height:a.height+"px",frameborder:"0",src:Gcc.baseURL+Gcc.webContext+(b&&b.uri)});window.setTimeout(function(){$("create_popup").insert({top:c})},300)};Gcc.showInfo=function(a){Dialog.closeInfo();Dialog.info(Gcc.locale.get("loadingText"),{width:a&&a.width||296,height:a&&a.height||56});if(a&&a.info){Dialog.setInfoMessage(a.info)}};Gcc.closeInfo=function(){Dialog.closeInfo();Dialog.dialogId=null;if(!Gcc.showingModal){setTimeout(function(){var a=$("overlay_modal");if(a&&a.visible()&&!Gcc.showingModal){a.hide()}},800)}if(Windows.focusedWindow){Dialog._focusBtn(Windows.focusedWindow.getId())}};Gcc.errConfig={};Gcc.errConfig.index=0;Gcc.errChar=null;Gcc.showErrMsg=function(b,h,m){var k,g=Gcc.errConfig.index,i=Gcc.errConfig.insertEl,j=Gcc.errConfig.highlightEl,l=Gcc.errConfig.className,f=Gcc.errConfig.headerInfo,d=Gcc.errConfig.highlightLabel,c=$(document.body);var a=function(n){if(!n){return}n.addClassName(l?l:"errorinput")};if(!m){if(c.select("div.error-container").length==0){var e=['<div class="error-container">','<div class="clear"><img align="absmiddle" class="big-warning" src="'+Gcc.BLANK_IMAGE_URL+'" />{HeaderErrMsg}</div>',"</div>"].join("");if(g!=3){e="<tr><td>"+e+"</td></tr>";k=c.select("tr.listheading")[g]||c.select("div.mod-hd")[g]}else{k=h?$(h):c}k.insert({after:e.replace(/{HeaderErrMsg}/g,f?f:Gcc.locale.get("errMsgHeaderInfo"))})}}e=['<div class="errorlabel">','<img align="absmiddle" class="small-warning" src="'+Gcc.BLANK_IMAGE_URL+'" />{LabelErrMsg}',"</div>"].join("");if($(i)){$(i).insert({after:e.replace(/{LabelErrMsg}/g,b)});if(j){if(j instanceof Array){j.each(function(n){a($(n))})}else{j=$(j);a(j)}}else{j=$(i);a(j)}}if(d){if(d instanceof Array){d.each(function(n){$(n).addClassName("error-text")})}else{if($(d)){$(d).addClassName("error-text")}}}Gcc.autoAdjustPopup()};Gcc.clearErrMsg=function(a){var b=$(a)?$(a):$(document.body);b.select("div.error-container").each(function(c){var d=Gcc.errConfig.index!=3?c.parentNode.parentNode:c;if($(d)){$(d).remove()}});b.select("div.errorlabel").each(Element.remove);b.select(".error-text",".errorinput",".errorlabel").each(function(c){var d=$(c);if(d){d.removeClassName("error-text");d.removeClassName("errorlabel");d.removeClassName("errorinput")}});Gcc.autoAdjustPopup()};Gcc.autoAdjustPopup=function(a){if(typeof Windows!="undefined"&&Windows.focusedWindow){Windows.focusedWindow.updateHeight();if(a===true){Windows.focusedWindow._center()}}};Gcc.setOverflow=function(a){$$(a).each(function(c){c.setStyle({width:"1px",overflow:"hidden",whiteSpace:"nowrap"});var b=c.up().getWidth();c.setStyle({width:b+"px"})})};Gcc.setTooltip=function(c){var a=$(c);var b=$(c+"_hover");if(a&&b){a.stopObserving();b.stopObserving();b.observe("mouseover",function(){b.show()});b.observe("mouseout",function(){b.hide()});a.observe("mouseover",function(){var d=a.cumulativeOffset();b.setStyle({top:d[1]+"px",left:d[0]+"px"});b.show()});a.observe("mouseout",function(){b.hide()})}};Gcc.setLinkActivation=function(e,c){var b=$(e);if(b){var a=b.innerHTML.replace("$A_LINK",'<a class="click-here" href="#">').replace("$A_LINK_END","</a>");b.update(a);var d=b.down("a.click-here");if(d){d.stopObserving("click");d.observe("click",c)}}};Gcc.setImagePreview=function(c){var b=c.url,e=new Image(),d=$(c.imageEl),a=Gcc.locale.get("IMAGE_PREVIEW")+" "+c.title;Gcc.showWindow(c.renderTo,{title:'<span class="preview-title" title="'+a+'">'+a+"</span>",width:c.width,height:c.height});loading();if(Gcc.isSecure){b=b.replace("http:","https:")}e.onload=function(){this.onload=null;var i,j=c.scaleWidth||202,g=c.scaleHeight||135,h=e.width,f=e.height;if((h>j)||(f>g)){if(h>f){i=h/f;e.width=j;e.height=j/i}else{i=f/h;e.height=g;e.width=g/i}}d.width=e.width;d.height=e.height;d.src=b;d.stopObserving("click");d.observe("click",function(){window.open(b,"_blank")});setTimeout(function(){Gcc.autoAdjustPopup()},300);successResults();return true};e.src=b};Gcc.setSlidesPreview=function(s){var h=s.xmlDoc,u=Gcc.locale.get("PUBLISHED_PPT_PREVIEW")+" "+s.title;if(!h){return}Gcc.showWindow(s.renderTo,{title:'<span class="preview-title" title="'+u+'">'+u+"</span>",width:s.width,height:s.height});var p,q,j=0,e="preview",l="",f=[],d=[],t=$("slide_display"),g=$("slide_title"),b=$("btn_prev_slide"),c=$("btn_next_slide"),n=$(s.nameEl),k=s.url,a=k.substring(0,k.lastIndexOf("/")),o=a+"/"+e+"/";for(p=0,q=h.childNodes.length;p<q;p++){var r=h.childNodes[p];if(r.nodeType!=3&&r.tagName.toLowerCase()=="slide"){f.push(r)}}for(p=0,q=f.length;p<q;p++){var m=f[p];d.push({slideTitle:m.getAttribute("title"),imageName:o+"Slide_"+(p+1)+".png"})}n.update(s.name);l="Slide1: "+d[0]["slideTitle"];t.src=d[0]["imageName"];t.title=l;g.update(l);if(c){c.stopObserving("click");c.observe("click",function(){j++;if(j>d.length-1){j=0}t.src=d[j]["imageName"];l="Slide"+(j+1)+": "+d[j]["slideTitle"];t.title=l;g.update(l)})}if(b){b.stopObserving("click");b.observe("click",function(){j--;if(j<0){j=d.length-1}t.src=d[j]["imageName"];l="Slide"+(j+1)+": "+d[j]["slideTitle"];t.title=l;g.update(l)})}};Gcc.setCharCount=function(f,b,a){var d=$(f);var c=function(){var k=$(b),i=d.value,g="",p=0,l=0,m=i.length,h=a;if(Prototype.Browser.Gecko){i.scan("\n",function(){p++})}var j=a-p;if(m<=j){h=j-m}else{g=i.substring(j);g.scan("\n",function(){l++});h=0;var o=j+(Prototype.Browser.Gecko?2*l:l);if(o>a){if(o==a+1){if(i.endsWith("\n")){o=a}else{o=a-2;h=2}}else{o=a}}d.value=i.substring(0,o)}if(k){k.update("["+h+"]")}};c();var e=function(){setTimeout(function(){c()},200)};d.observe("keyup",c);d.observe(Prototype.Browser.Gecko?"input":"paste",e);d.observe("drop",e);d.observe("dragdrop",e)};Gcc.ComboBox=function(b,a){this.opt=a||{};this.opt.inputClass=this.opt.inputClass||"selectbox";this.opt.containerClass=this.opt.containerClass||"selectbox-wrapper";this.opt.hoverClass=this.opt.hoverClass||"current";this.opt.currentClass=this.opt.currentClass||"selected";this.opt.applyStyles=this.opt.applyStyles||null;this.opt.width=this.opt.width||200;this.opt.trim=this.opt.trim||20;this.opt.readOnly=(this.opt.readOnly!==false);this.opt.inputMaxLength=this.opt.inputMaxLength||null;this.opt.clickDropdown=this.opt.clickDropdown||null;this.select=$(b);this.container=null;this.input=null;this.useShim={initOnce:true,shim:null}};Gcc.ComboBox.prototype={active:-1,inFocus:false,hasfocus:0,init:function(){this.container=this.setupContainer();this.input=this.setupInput();$(document.body).insert({top:this.container});this.select.insert({before:this.input});this.select.hide();this.reloadOptions();if(this.opt.applyStyles){this.input.setStyle(this.opt.applyStyles)}this.input.setStyle({width:this.opt.width-16+"px"});this.container.setStyle({width:this.opt.width+"px"});this.addEvents();if(Gcc.platform.isIE6){this.useShim.shim=this.createShim()}},setupContainer:function(){var b=this.select.identify()+"_container";if($(b)){$(b).remove()}var a=document.createElement("div");this.container=$(a);this.container.id=b;this.container.addClassName(this.opt.containerClass);this.container.setStyle({overflow:"hidden"});this.container.hide();return this.container},setupInput:function(){var a=document.createElement("input");this.input=$(a);this.input.id=this.select.identify()+"_input";if($(this.input.id)){$(this.input.id).remove()}this.input.writeAttribute("type","text");this.input.addClassName(this.opt.inputClass);this.input.writeAttribute("autocomplete","off");if(this.opt.readOnly){this.input.writeAttribute("readonly","readonly")}else{if(this.opt.inputMaxLength){this.input.writeAttribute("maxLength",this.opt.inputMaxLength)}}if(this.select.tabIndex){this.input.writeAttribute("tabIndex",this.select.tabIndex)}return this.input},createShim:function(){var a=document.createElement("iframe");a.src="javascript:false";a.frameBorder=0;a.className="use-shim";return $(a)},addEvents:function(){var a=this;this.container.observe("mouseover",function(){a.hasfocus=1});this.container.observe("mouseout",function(){a.hasfocus=-1;if(Prototype.Browser.IE){a.input.focus()}});this.input.observe("mouseover",function(){a.input.addClassName("combo-hover")});this.input.observe("mouseout",function(){a.input.removeClassName("combo-hover")});this.input.observe("click",function(){var b=a.input.cumulativeOffset();var f=a.input.cumulativeScrollOffset();a.container.setStyle({left:b[0]-f[0]+1+"px",top:b[1]-f[1]+20+"px"});if(Gcc.platform.isIE6){if(a.useShim.initOnce){a.useShim.initOnce=false;a.container.insert({after:a.useShim.shim})}var e=a.container.childElements()[0].childElements().length*19-10;if(a.opt.dropdownHeight&&e>a.opt.dropdownHeight){e=a.opt.dropdownHeight}a.useShim.shim.setStyle({left:a.container.getStyle("left"),top:a.container.getStyle("top"),width:a.container.getStyle("width"),height:e+"px",zIndex:a.container.getStyle("z-index")-2,visibility:"visible"})}a.container.toggle();if(!a.container.visible()){a.hideList()}else{var d=a.container.select("li."+a.opt.currentClass)[0];if(d){d.removeClassName(a.opt.currentClass)}var c=a.select.selectedIndex;a.container.select("li")[c].addClassName(a.opt.currentClass)}});this.input.observe("focus",function(){if(a.container.visible()){a.inFocus=true;a.container.show()}});this.input.observe("keydown",function(c){switch(c.keyCode){case 38:c.preventDefault();a.moveSelect(-1);break;case 40:c.preventDefault();a.moveSelect(1);break;case 13:c.preventDefault();a.container.select("li."+a.opt.currentClass).each(function(d){d.removeClassName(a.opt.currentClass)});var b=$(a.container.select("li."+a.opt.hoverClass)[0]);if(b){b.removeClassName(a.opt.hoverClass);b.addClassName(a.opt.currentClass);a.setCurrSelect()}a.hideList();break;case 27:a.hideList();break}});this.input.observe("blur",function(){if(!(a.container.visible()&&a.hasfocus>0)){a.hideList()}})},moveSelect:function(c){var b=this;var a=this.container.select("li");if(!a){return}this.active+=c;if(this.active<0){this.active=0}else{if(this.active>=a.size()){this.active=a.size()-1}}a.each(function(d){d.removeClassName(b.opt.hoverClass)});$(a[this.active]).addClassName(this.opt.hoverClass)},setCurrSelect:function(){var b=this.container.select("li."+this.opt.currentClass)[0];var a=b.id.split("_");this.select.value=a[a.length-1];if(typeof this.select.onchange=="function"){this.select.onchange()}this.input.value=$(b).title.truncate(this.opt.trim);this.input.title=$(b).title;return true},hideList:function(){this.hasfocus=0;this.container.hide();if(Gcc.platform.isIE6){this.useShim.shim.style.visibility="hidden"}},getOptions:function(c){var a=document.createElement("ul");var b=this;this.select.childElements().each(function(e){var d=document.createElement("li");d.id=c+"_"+e.value;d.title=e.text;d.appendChild(document.createTextNode(e.text));if(e.selected){b.input.value=e.text.truncate(b.opt.trim);b.input.title=e.text}a.appendChild(d);var f=$(d);f.observe("mouseover",function(h){var g=h.element();b.hasfocus=1;g.addClassName(b.opt.hoverClass);b.input.addClassName("combo-hover")});f.observe("mouseout",function(h){var g=h.element();b.hasfocus=-1;g.removeClassName(b.opt.hoverClass);b.input.removeClassName("combo-hover")});f.observe("click",function(h){var g=h.element();b.container.select("li."+b.opt.currentClass).each(function(i){i.removeClassName(b.opt.currentClass)});g.addClassName(b.opt.currentClass);b.setCurrSelect();if(typeof b.opt.clickDropdown=="function"){b.opt.clickDropdown()}b.hideList()})});if(this.select.selectedIndex==0){this.input.value=this.select.options[0].text.truncate(this.opt.trim);this.input.title=this.select.options[0].text}return a},reloadOptions:function(){this.container.update("");this.container.appendChild(this.getOptions(this.input.id));this.adjustUI()},adjustUI:function(){var a=this,d=this.container.childElements()[0].childElements(),b=false,c=d.length*19;if(this.opt.dropdownHeight&&c>this.opt.dropdownHeight){b=true}d.each(function(e){var f=$(e);if(b){f.setStyle({width:a.opt.width-21+"px",whiteSpace:"nowrap",overflow:"hidden"})}else{f.setStyle({width:a.opt.width+"px",whiteSpace:"nowrap",overflow:"hidden"})}});if(b){this.container.setStyle({height:this.opt.dropdownHeight+"px",overflow:"auto"})}}};Gcc.apply(Date,{monthEnNames:["January","February","March","April","May","June","July","August","September","October","November","December"]});Gcc.DatePicker=function(a){this.opt=a||{};this.opt.currentDate=a.currentDate||new Date();this.opt.containerCls=a.containerCls||"cal-dropdown";this.opt.datepickerCls=a.datepickerCls||"datepicker";this.opt.disableRange=a.disableRange||false;this.opt.monthNames=a.months||Date.monthNames;this.opt.yearNames=a.years||[];this.opt.lang=a.language||"en";this.opt.langCodes=a.langCodes||[];this.opt.dayFormat=this.opt.langCodes.include(this.opt.lang)?("j"+Gcc.locale.get("DAY_ZS_JA")):"j";this.opt.yearFormat=this.opt.langCodes.include(this.opt.lang)?("Y"+Gcc.locale.get("YEAR_ZS_JA")):"Y";this.opt.disableDateDropdown=a.disableDateDropdown;this.opt.enableDateDropdown=a.enableDateDropdown;this.mode=(a.mode&&a.mode.toLowerCase())||"dropdown";this.buttons=null;this.datepicker=null;this.activeDate=null;this.triggerBtn=null;this.navDropdown=null;this.useShim={initOnce:true,shim:null}};Gcc.DatePicker.prototype={init:function(a){this.buttons=a;this.setLayoutView();this.addEvents();this.selectToday(this.opt.currentDate);if(Gcc.platform.isIE6){this.useShim.shim=this.createShim()}},setLayoutView:function(){this.navDropdown=new Element("div",{"class":this.opt.containerCls});this.navDropdown.hide();this.datepicker=new Element("div",{"class":this.opt.datepickerCls});this.datepicker.hide();this.datepicker.insert('<div class="dp-wrap"><div class="cal-nav-wrap"></div><div class="cal-nav-info"></div><div class="cal-pane-wrap"></div><div class="clear"></div></div>');this.setNavView();this.setPaneView();var a=$(document.body);a.insert({top:this.navDropdown});a.insert({top:this.datepicker})},setNavView:function(){var c=Gcc.locale.get("PREVIOUS_MONTH");var e=Gcc.locale.get("NEXT_MONTH");var d=Gcc.locale.get("SELECT_MONTH");var b=Gcc.locale.get("SELECT_YEAR");var a=Gcc.locale.get("TODAY");this.datepicker.down("div.cal-nav-wrap").insert('<div class="cal-nav"><ul><li class="arrow-wrap" title="'+c+'"><span class="arrow-lt"></span></li><li class="month-wrap" title="'+d+'"><div class="nav-month"></div><span class="arrow-down"></span></li><li class="year-wrap" title="'+b+'"><div class="nav-year"></div><span class="arrow-down"></span></li><li class="arrow-wrap" title="'+e+'"><span class="arrow-rt"></span></li></ul><div class="clear"></div></div>');this.datepicker.down("div.cal-nav-info").insert('<a href="#" title="'+a+'">'+a+"</a><span></span>")},setPaneView:function(){var f=Gcc.locale.get("SN"),e=Gcc.locale.get("M"),d=Gcc.locale.get("T"),c=Gcc.locale.get("W"),a=Gcc.locale.get("TH"),h=Gcc.locale.get("F"),g=Gcc.locale.get("S"),b=Gcc.locale.get("CLOSE");this.datepicker.down("div.cal-pane-wrap").insert('<ul class="cal-pane-hd"><li>'+f+"</li><li>"+e+"</li><li>"+d+"</li><li>"+c+"</li><li>"+a+"</li><li>"+h+"</li><li>"+g+'</li></ul><div class="cal-pane-bd"></div><div class="cal-pane-ft"><a href="#" title="'+b+'" class="btn-small-close">'+b+"</a></div>");this.onRenderPaneView()},onRenderPaneView:function(){var d=this.datepicker.down("div.cal-pane-bd");d.update("");var b=['<table class="dp-grid"><tr>'];for(var c=0;c<42;c++){if(c%7==0&&c!=0){b.push("</tr><tr>")}b.push('<td><a hidefocus="on" href="#">&#160;</a></td>')}b.push("</tr></table>");d.update(b.join(""));this.cellDays=d.select("table.dp-grid td a")},onClickEvtDropdown:function(c,b,a){var d=this;c=$(c);c.observe("click",function(){if(d.timer){window.clearTimeout(d.timer)}d.setListDropdown(b,a);var e=c.cumulativeOffset();d.navDropdown.setStyle({left:e[0]+1+"px",top:e[1]+19+"px",width:c.getWidth()-2+"px",height:"auto"});d.navDropdown.show()})},onClickEvtListDropdown:function(b){var c=this;var a=$$(".cal-dropdown ul li a");a.each(function(d){if(!d.hasClassName("state-grey")){d.observe("click",function(){var e,f=d.firstChild.nodeValue;if(b=="year"){f=parseInt(f,10);e=f-c.activeDate.getFullYear();c.activeDate=c.activeDate.add("y",e)}else{e=Date.monthNumbers[d.readAttribute("monthitem").substring(0,3)]-(c.activeDate.format("n")-1);c.activeDate=c.activeDate.add("mo",e)}c.navDropdown.hide();c.enableNavButtonGroup();c.update(c.activeDate);c.selectActiveMonth();c.selectActiveYear()})}})},onMouseEvtDropdown:function(){var a=this;this.navDropdown.observe("mouseover",function(){a.navDropdown.show();if(a.timer){window.clearTimeout(a.timer)}});this.navDropdown.observe("mouseout",function(){a.timer=window.setTimeout(function(){a.navDropdown.hide()},800)})},setListDropdown:function(a,b){this.navDropdown.update("");var c=b=="year"?this.activeDate.format("Y"):this.activeDate.format("n");var f=0,e=this.opt.currentDate;if(this.opt.disableRange&&this.activeDate.getFullYear()==e.getFullYear()-1){f=e.getMonth()}var d=new Element("ul");a.each(function(h,g){var i,j,k="";if(b=="month"){i="month";i=g<f?i+" state-grey":i;k="monthitem="+Date.monthEnNames[g];j=(g==c-1)?' class="select-item"':""}else{i="year";j=(h==c)?' class="select-item"':""}d.insert("<li"+j+'><a class="'+i+'" href="#" '+k+' title="'+h+'">'+h+"</a></li>")});this.navDropdown.insert(d);this.onClickEvtListDropdown(b)},createShim:function(){var a=document.createElement("iframe");a.src="javascript:false";a.frameBorder=0;a.className="use-shim";return $(a)},closeDatePicker:function(){this.datepicker.hide();if(Gcc.platform.isIE6){this.useShim.shim.style.visibility="hidden"}if(typeof this.opt.enableDateDropdown=="function"){this.opt.enableDateDropdown()}},setNavButtonStatus:function(d,c){var b=this.datepicker.down("span.arrow-lt").up("li");var a=this.datepicker.down("span.arrow-rt").up("li");if(c=="enable"){if(d=="next"){a.removeClassName("state-grey")}else{b.removeClassName("state-grey")}}else{if(d=="next"){a.addClassName("state-grey")}else{b.addClassName("state-grey")}}},enableNavButtonGroup:function(){this.setNavButtonStatus("prev","enable");this.setNavButtonStatus("next","enable")},addEvents:function(){var c=this;var a=this.datepicker.down("li.month-wrap");var d=this.datepicker.down("li.year-wrap");this.onMouseEvtDropdown();this.onClickEvtDropdown(a,this.opt.monthNames,"month");this.onClickEvtDropdown(d,this.opt.yearNames,"year");var b=function(e){$(e).observe("click",function(){c.triggerBtn=this;var g=c.triggerBtn.previous(0);if(c.mode=="dropdown"){g=g.match("select")?g:g.down("select")}if(!g.disabled){var f=this.cumulativeOffset();c.datepicker.setStyle({left:f[0]-183+"px",top:f[1]+17+"px"});if(Gcc.platform.isIE6){if(c.useShim.initOnce){c.useShim.initOnce=false;c.datepicker.insert({after:c.useShim.shim})}c.useShim.shim.setStyle({left:c.datepicker.getStyle("left"),top:c.datepicker.getStyle("top"),width:c.datepicker.getStyle("width"),height:c.datepicker.getStyle("height"),zIndex:c.datepicker.getStyle("z-index")-2,visibility:"visible"})}c.selectToday(c.opt.currentDate);c.datepicker.show();if(typeof c.opt.disableDateDropdown=="function"){c.opt.disableDateDropdown()}}})};if(this.buttons instanceof Array){this.buttons.each(function(e){b(e)})}else{b(this.buttons)}this.datepicker.down("a.btn-small-close").observe("click",function(){c.closeDatePicker()});this.datepicker.down("div.cal-nav-info a").observe("click",function(){var e=c.opt.currentDate;c.pickDate(e.format("Y"),e.format("n"),e.format("j"))});this.datepicker.down("span.arrow-lt").up("li").observe("click",function(){c.showPrevMonth()});this.datepicker.down("span.arrow-rt").up("li").observe("click",function(){c.showNextMonth()});this.cellDays.each(function(e){e.observe("click",function(){var g=c.activeDate;if(e.hasClassName("prev-month")){g=g.add("mo",-1)}else{if(e.hasClassName("next-month")){g=g.add("mo",1)}}var i=g.format("Y");var f=g.format("n");var h=this.firstChild.nodeValue;c.pickDate(i,f,h)})});document.observe("keydown",function(e){if(e.keyCode==Event.KEY_ESC){if(this.datepicker.visible()){c.closeDatePicker()}}}.bind(this))},selectOption:function(b,a){b.select("option").each(function(c){if(c.value==a){c.selected=true}})},pickDate:function(g,a,e){var c=this.mode=="dropdown"?this.triggerBtn.previous(1):this.triggerBtn.previous(0);var f=a+"/"+e+"/"+g;if(this.mode=="dropdown"){var d=c.match("select")?c:c.down("select");var b=new Date(f);if(typeof fnInitScheduleDateDropdown=="function"){fnInitScheduleDateDropdown(b,d,"day")}this.selectOption(this.triggerBtn.previous(0),g);this.selectOption(this.triggerBtn.previous(2),a);this.selectOption(d,e)}else{if(this.mode=="textfield"){c.value=f}}this.closeDatePicker()},showPrevMonth:function(){var a=this.opt.disableRange&&(this.activeDate<=this.opt.currentDate.add("y",-1));if(!a){this.enableNavButtonGroup();this.activeDate=this.activeDate.add("mo",-1);this.update(this.activeDate);this.selectActiveMonth();this.selectActiveYear()}},showNextMonth:function(){var a=this.opt.yearNames;var b=this.opt.disableRange&&this.activeDate.getMonth()==11&&this.activeDate.getFullYear()==a[a.length-1];if(!b){this.enableNavButtonGroup();this.activeDate=this.activeDate.add("mo",1);this.update(this.activeDate);this.selectActiveMonth();this.selectActiveYear()}},selectActiveYear:function(){this.datepicker.down("div.nav-month").update(this.activeDate.format("F"))},selectActiveMonth:function(){this.datepicker.down("div.nav-year").update(this.activeDate.format("Y"))},selectToday:function(a){this.activeDate=a;if(this.datepicker){this.datepicker.down("div.nav-month").update(a.format("F"));this.datepicker.down("div.nav-year").update(a.format("Y"));var b=this.datepicker.down("div.cal-nav-info span");if(b.empty()){b.update(a.format("F "+this.opt.dayFormat+", "+this.opt.yearFormat))}}this.update(a)},update:function(c){var e=this.opt.currentDate;var l=c.getDaysInMonth();var h=c.getDate();var f=c.getFirstDateOfMonth().getDay();var k=c.add("mo",-1).getDaysInMonth()-f;var g,m,n=this.cellDays,b=0;if(!n){n=$$("table.dp-grid td a")}var d=0;for(;d<f;d++){g=++k;m=n[d];m.removeClassName("select-day");m.removeClassName("today");if(!m.hasClassName("prev-month")){m.addClassName("outside prev-month")}m.update(g);m.title=g}for(;d<f+l;d++){g=d-(f-1);m=n[d];m.removeClassName("outside");m.removeClassName("select-day");m.removeClassName("today");m.removeClassName("prev-month");m.removeClassName("next-month");m.update(g);m.title=g;if(g==h){m.addClassName("select-day");if(e.getMonth()==c.getMonth()&&e.getFullYear()==c.getFullYear()){m.addClassName("today")}}}for(;d<42;d++){g=++b;m=n[d];m.removeClassName("select-day");m.removeClassName("today");if(!m.hasClassName("next-month")){m.addClassName("outside next-month")}m.update(g);m.title=g}this.enableNavButtonGroup();if(this.opt.disableRange){var j=this.activeDate;if(j<=e.add("y",-1)){this.setNavButtonStatus("prev","disable")}var a=this.opt.yearNames;if(j.getMonth()==11&&j.getFullYear()==a[a.length-1]){this.setNavButtonStatus("next","disable")}}}};Gcc.locale.update({loadingText:"loading...",closeText:"close",okText:"ok",yesText:"yes",noText:"no",errMsgHeaderInfo:"One or more fields below may contain errors. Please review.",loadingInfo:"loading...",savingInfo:"saving..."});